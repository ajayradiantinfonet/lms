{% extends 'head2.html' %} {% block inner_content %} {% load static %} {% load i18n %}







<style>
    @media only screen and (min-width:1030px) and (max-width:1366px) {
        #cards_landscape_wrap-2 .card-flyer .img-height img {
            height: 110px;
        }
        .btn-save {
            float: right;
            position: relative;
            top: 2px;
            right: 5px;
        }
        .height-card1 {
            height: 240px;
        }
        #cards_landscape_wrap-2 .card-flyer .text-box h6 {
            font-size: 10px;
        }
        .right_col {
            min-height: 635px !important;
        }
        .custom-file-upload .custom-file-upload2 {
            font-size: 11px;
        }
        .profile_p {
            font-size: 11px;
        }
        .save-delete1 {
            font-size: 11px;
        }
        .ul-management li {
            margin: 0px 3px !important;
            font-size: 10px !important;
        }
        .ul-management img {
            width: 12px !important;
        }
        #cards_landscape_wrap-2 .card-flyer .text-box .text-container {
            padding: 10px 1px;
        }
    }
    
    .next {
        background-color: #33ACFF;
        color: white;
    }
    
    #aa {
        text-decoration: none;
        display: inline-block;
        padding: 8px 16px;
    }
    
    #aa:hover {
        background-color: #5EB685;
        color: white;
    }
</style>



{% load crispy_forms_tags %}

<div class="right_col" role="main">

    {% if messages %} {% for message in messages %}
    <div class="alert alert-dismissible alert-{{ message.tags }}">
        <button type="button" class="close" data-dismiss="alert">
                      <i class="fa fa-close"></i>
                  </button>
        <strong>{{ message }}</strong>
    </div>
    {% endfor %} {% endif %}


    <div class="row">
        <div class="col-md-12 col-sm-12 ">
            <div class="dashboard_graph border_radius">
                <div class="col-md-6 col-sm-6 border_radius1">
                    <h2>Edit Company</h2>
                </div>
                <div class="col-md-6 col-sm-6 left-courses border_radius1">
                    <a href="{% url 'customadmin:admin_home' %}" style="text-decoration: none;color: #5EB685">
                        <p>Dashboard<i class="fa fa-angle-right" aria-hidden="true"></i></p>
                    </a>
                    <a href="{% url 'customadmin:all_organization' %}" style="text-decoration: none;color: #5EB685">
                        <p>Company<i class="fa fa-angle-right" aria-hidden="true"></i></p>
                    </a>
                    <a href="#">
                        <p>Edit Company<i></i></p>
                    </a>
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>
    <br>

    <!--row 2  -->
    <div class="row">
        <div class="col-md-12 col-sm-12 ">
            <div class="x_panel company_height">
                <!--   <div class="x_content"> -->
                <ul class="nav add-company" id="myTab" role="tablist">
                    <li class="nav-item add-li">
                        <a class="nav-link active detail_font add-a" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Company Information</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link detail_font2" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Company Address</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link detail_font2" id="profile1-tab" data-toggle="tab" href="#profile1" role="tab" aria-controls="profile" aria-selected="false">Company Documents</a>
                    </li>
                    <!--  <li class="nav-item">
                        <a class="nav-link detail_font2" id="profile2-tab" data-toggle="tab" href="#profile2" role="tab" aria-controls="profile" aria-selected="false">Appearance</a>
                      </li>
                      
                      <li class="nav-item">
                        <a class="nav-link detail_font2" id="profile3-tab" data-toggle="tab" href="#profile3" role="tab" aria-controls="profile" aria-selected="false">Users</a>
                      </li> -->
                </ul>
                <!---course details--->
                <div class="tab-content" id="myTabContent">
                    <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                        <!-- Company Information -->

                        <br/><br/>


                        <form id="form_org" enctype="multipart/form-data" method="post">


                            <div class="row">
                                <div class="col-md-8">






                                    <div class="col-md-12">
                                        <h2 class="head-tag">Organization Name:*</h2>
                                        <!--<input type="text" id="organization_name_id"  class="form-control" name="organization_name"> -->
                                        {{ form.organization_name}}
                                    </div>




                                    <div class="col-md-12">
                                        <h2 class="head-tag">Assigned Person Name:*</h2>
                                        {{ form.contact_person_name}}




                                        <!-- <h2 class="head-tag">Assigned Person Name:*</h2>
                        <input type="text" id="contact_person_name_id"  class="form-control" name="contact_person_name"> -->
                                    </div>




                                    <div class="col-md-6">
                                        <h2 class="head-tag">Assigned Person Mobile Number:*</h2>
                                        <!--<input type="text" id="contact_person_phone_id" class="form-control" name="contact_person_phone"> -->
                                        {{ form.contact_person_phone }}

                                    </div>




                                    <div class="col-md-6">
                                        <h2 class="head-tag">Assigned Person Email-ID:*</h2>
                                        {{ form.contact_person_email }}
                                        <!--  <input type="text" id="contact_person_email_id" class="form-control" name="contact_person_email"> -->
                                    </div>

                                    <!-- <div class="col-md-6">
                                        <h2 class="head-tag">Password:*</h2>
                                        {{ form.password}}


                                     <input type="text" id="password" class="form-control" name="password"> -->
                                    <!-- </div> -->

                                    <!-- <div class="col-md-6">
                                    <h2 class="head-tag">Password Again:*</h2>
                                    {{ form.password_again}} -->
                                    <!-- <input type="text" id="password" class="form-control"
                                       name="password_again"> 
                                    </div> -->


                                    {% csrf_token %}

                                    <div class="col-md-6">
                                        <h2 class="head-tag">Sector:*</h2>
                                        {{ form.sector_type }}
                                    </div>




                                    <div class="col-md-6">
                                        <h2 class="head-tag">No Of Users</h2>
                                        {{ form.no_of_candidates }}
                                    </div>





                                    <!-- <div class="col-md-12">
                    <h2 class="head-tag">Assigned Person Name</h2>
                    <input type="text" id="fullname" name="contact_person_name" class="form-control" >
                 </div>
                  <div class="col-md-6">
                      <h2 class="head-tag">Assigned Person Mobile Number</h2>
                    <input type="text" id="fullname" class="form-control" name="fullname">
                    </div>
                    <div class="col-md-6">
                      <h2 class="head-tag">Assigned Person E-mail ID</h2>
                    <input type="text" id="fullname" class="form-control" name="fullname">
                    </div>
                  <div class="col-md-6">
                      <h2 class="head-tag">Sector</h2>
                    <input type="text" id="fullname" class="form-control" name="fullname">
                    </div>
                    <div class="col-md-6">
                      <h2 class="head-tag">No of Users</h2>
                    <input type="text" id="fullname" class="form-control" name="fullname">
                    </div> -->
                                </div>
                                <!-- /col-8 -->

                                <div class="col-md-4">
                                    <!--thumbnail-->
                                    <h2 class="head-tag">Logo</h2>

                                    <div class="thumb_nail1">
                                        {% if obj.logo %}
                                        <img src="{{ obj.logo.url }}" style="width:200px;height:150px;" alt=""> {% else %}
                                        <img src="{% static 'boimage/logo.jpg' %}" style="width:200px;height:150px;" alt=""> {% endif%}
                                    </div>
                                    <div class="company_upload">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <p class="profile_p">
                                                    Upload Profile:
                                                </p>
                                            </div>
                                            <div class="col-md-6">
                                                {{ form.logo }}
                                                <!-- <div class="custom-file-upload  custom-file-upload-1">
                        <label for="logo" class="right_btn up-load">
                        
                        </label>

                        
                        <input id="file-upload" class="logo_upload"
                         type="file"/> 
                        </div> -->
                                            </div>
                                            <!-- <div class="col-md-6">
                          <button type="submit" class="btn save-delete1">Upload</button>
                        </div> -->
                                            <div class="col-md-6"><br/> Another Logo :{{ form.logo1 }}<br/><br/> Show Partner Logo :{{ form.show_second_logo }}<br/><br/>
                                            </div>



                                        </div>
                                    </div>


                                </div>
                                <!-- /col-4 -->
                            </div>
                            <!-- /row -->




                            <div class="btn-save">
                                <a id="aa" class="next" id="profile-tab" data-toggle="tab" href="#profile">SAVE & NEXT</a>

                            </div>

                            <!-- <div class="btn-save">
                                <button type="save" value="save" class="btn btn-primary save-delete3">SAVE & NEXT</button>
                            </div> -->

                    </div>
                    <!-- /tab-pane-->

                    <br/><br/>
                    <!-- /Company Information-->

                    <!---Company Address--->
                    <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                        <div class="col-md-12">


                            <div class="col-md-6">
                                <h2 class="head-tag">Address</h2>
                                <!-- <input type="text" id="fullname" class="form-control" name="fullname"> -->
                                {{ form.address }}
                            </div>

                            <div class="col-md-4">
                                <h2 class="head-tag">Website</h2>
                                <!-- <input type="text" id="fullname" class="form-control" name="fullname"> -->
                                {{ form.website }}
                            </div>


                            <div class="col-md-4">
                                <h2 class="head-tag">City</h2>
                                <!-- <input type="text" id="fullname" class="form-control" name="fullname"> -->
                                {{ form.city }}
                            </div>
                            <div class="col-md-4">
                                <h2 class="head-tag">State</h2>
                                <!--  <input type="text" id="fullname" class="form-control" name="fullname"> -->
                                {{ form.state }}
                            </div>
                            <div class="col-md-4">
                                <h2 class="head-tag">Pincode</h2>
                                {{ form.pin }}
                                <!-- <input type="text" id="fullname" class="form-control" name="fullname">
 <!-- --></div>
                            <!-- <div class="col-md-4">
                                <h2 class="head-tag">End Date</h2>
                                {{ form.end_date }}
                                <!-- <input type="text" id="fullname" class="form-control" name="fullname"> 
                        </div> -->
                            <!-- <div class="col-md-4">
                      <h2 class="head-tag">End Date</h2>
                    <input type="text" id="fullname" class="form-control" name="fullname">
                    </div> -->
                            <div class="col-md-4">
                                <h2 class="head-tag">Organisation Code*</h2>
                                {{ form.unique_code }}
                            </div>

                            {{ form.certificate }}


                        </div>
                        <!-- /col-12 -->
                        <div class="btn-save">
                            <a id="aa" class="next" id="profile-tab" data-toggle="tab" href="#profile1">SAVE & NEXT</a>

                        </div>

                        </form>
                    </div>
                    <!-- /tab-pane-->

                    <!-- /Company Address -->


                    <!---Company Documents--->
                    <div class="tab-pane fade" id="profile1" role="tabpanel" aria-labelledby="profile1-tab">


                        <div class="certificate_upper" id="certificate_upper" style="width:800px;height: 600px;padding:10px;">


                            <div class="certificate" data-href='{{ obj.certificate | safe }}' id="certificate" style="height: 580px;width:780px;">





                            </div>

                        </div>



                        <div class="col-md-12">
                            <div class="col-md-6">
                                <h2 class="head-tag">Certificate logo</h2>
                                <input type="text" readonly class="form-control">
                                <div class="custom-file-upload  custom-file-upload-1  btn-margin">
                                    <label for="logo" class="right_btn up-load">
                        Choose File
                        </label>
                                    <input name="logo" id="logo" type="file" />
                                </div>
                            </div>
                            <div class="col-md-6">
                                <button type="" class="btn save-delete2">Upload</button>
                            </div>

                        </div>
                        <!-- /col-12 -->
                        <div class="col-md-12">
                            <div class="col-md-6">
                                <h2 class="head-tag">Certificate Sign</h2>
                                <input type="text" class="form-control" readonly>
                                <div class="custom-file-upload custom-file-upload-1  btn-margin">
                                    <label for="sig" class="right_btn up-load">
                        Choose File
                        </label>
                                    <input id="sig" name="sig" type="file" />
                                </div>
                            </div>
                            <div class="col-md-6">
                                <button type="" class="btn save-delete2">Upload</button>
                            </div>

                        </div>
                        <!-- /col-12 -->
                        <!--  <div class="col-md-12">
                    <div class="col-md-6">
                      <h2 class="head-tag">Watermark</h2>
                    <input type="text" id="fullname" class="form-control" readonly >
                     <div class="custom-file-upload  custom-file-upload-1  btn-margin">
                        <label for="file-upload" class="right_btn up-load">
                        Choose File
                        </label>
                        <input id="file-upload" type="file"/>
                        </div>
                    </div>
                    <div class="col-md-6">
                          <button type="" class="btn save-delete2">Upload</button>
                    </div>
                 
                  </div> -->
                        <!-- /col-12 -->
                        <div class="col-md-12">
                            <div class="col-md-6">
                                <h2 class="head-tag">Background</h2>
                                <input type="text" class="form-control" readonly>
                                <div class="custom-file-upload  custom-file-upload-1  btn-margin">
                                    <label for="bi" class="right_btn up-load">
                        Choose File
                        </label>
                                    <input name="bi" id="bi" type="file" />
                                </div>
                            </div>
                            <div class="col-md-6">
                                <button type="" class="btn save-delete2">Upload</button>
                            </div>

                        </div>
                        <!-- /col-12 -->
                        <div class="col-md-12">
                            <div class="col-md-6">

                                <br/>
                                <h2 class="head-tag">Font Family</h2><select id="fonttype" class="form-control">
        
                          <option>Sans-serif</option>
                          <option>Sancreek</option>

                        </select>


                                <br/>

                                <h2 class="head-tag">Font Weight: </h2><select id="fontstyle" class="form-control">
                                <option value="400">Normal</option>
                                <option value="700">Bold</option>
                                <option value="1300">Bolder</option>

                            </select><br/>

                                <h2 class="head-tag">Font Size: </h2><select id="fontsize" class="form-control">
                                <option>10</option>
                                <option>11</option>
                                <option>12</option>
                                <option>13</option>
                                <option>14</option>
                                <option>15</option>
                                <option>16</option>
                                <option>18</option>
                                <option>19</option>
                                <option>20</option>
                                <option>21</option>
                                <option>22</option>
                                <option>23</option>
                                <option>24</option>
                                <option>25</option>
                                <option>26</option>
                                <option>27</option>
                                <option>28</option>

                                <option></option>
                                </select>
                                <br/>


                                <h2 class="head-tag">Select Color: </h2><input type="color" class="form-control" id="favcolor" name="favcolor" value="#ff0000" /> <br/>

                                <h2 class="head-tag"> Border Color:</h2><input type="color" class="form-control" id="bordercolor" name="bordercolor" value="#ff0000" /> <br/>

                                <h2 class="head-tag">Candidate Name : </h2><input type="text" class="form-control" id="canname" placeholder="please write a sample name or  anything" /> <br/>
                                <h2 class="head-tag">Certificate Text</h2>

                                <input type="text" id="text" name="text" class="form-control" />
                                <!-- <div class="custom-file-upload  custom-file-upload-1  btn-margin">
                        <label for="file-upload" class="right_btn up-load">
                        Choose File
                        </label>
                        <input id="file-upload" type="file"/>
                        </div> -->
                            </div>


                            <!-- <div class="col-md-6">
                          <button type="" class="btn save-delete2">Upload</button>
                    </div> -->

                        </div>
                        <!-- /col-12 -->
                        <!-- <div class="btn-save">
                          <button type="save" class="btn btn-primary save-delete3">SAVE & NEXT</button>
                    </div> -->
                        <div class="btn-save">
                            <input type="submit" value="submit" id="submit_ajax" class="btn save-delete3 btn-sub" />
                        </div>
                    </div>
                    <!-- /tab-pane-->

                    <!-- /Company Documents -->

                    <!---Appearance--->
                    <div class="tab-pane fade" id="profile2" role="tabpanel" aria-labelledby="profile1-tab">
                        <div class="col-md-12">
                            <div class="col-md-6">
                                <h2 class="head-tag">Banner Image</h2>
                                <input type="text" class="form-control" readonly>
                                <div class="custom-file-upload  custom-file-upload-1  btn-margin">
                                    <label for="file-upload" class="right_btn up-load">
                        Choose File
                        </label>
                                    <input id="" type="file" />
                                </div>
                            </div>
                            <div class="col-md-6">
                                <button type="" class="btn save-delete2">Upload</button>
                            </div>

                        </div>
                        <!-- /col-12 -->
                        <div class="btn-save">
                            <button type="save" class="btn btn-primary save-delete3">SAVE & NEXT</button>
                        </div>


                    </div>
                    <!-- /tab-pane-->

                    <!-- /Appearance-->

                    <!---Users--->

                    <div class="tab-pane fade" id="profile3" role="tabpanel" aria-labelledby="profile1-tab">
                        <div class="col-md-12">
                            <div class="box_bottom1">


                                <div id="cards_landscape_wrap-2">
                                    <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2">
                                        <div class="card-flyer height-card1">
                                            <div class="text-box">
                                                <div class="image-box img-height">
                                                    <img src="https://cdn.pixabay.com/photo/2018/03/30/15/11/deer-3275594_960_720.jpg" alt="" />
                                                    <span class="fa-img1">.
                                    <i class="fa fa-ellipsis-v  box_show" aria-hidden="true" >
                                      <ul style="display:none;" class="box_hide box-ul">
                                      <li>View</li>
                                       <li>Edit</li>
                                        <li>Suspend</li>
                                         <li>Delete</li>
                                    </ul>
                                    </i>
                                  </span>
                                                </div>
                                                <div class="text-container">
                                                    <h6>Sales Management</h6>
                                                    <ul class="ul-management">
                                                        <li><img src="images/education.svg" alt=""></li>
                                                        <li>Students</li>
                                                        <li>25 Students</li>
                                                    </ul>
                                                    <ul class="ul-management">
                                                        <li><img src="images/clock.svg" alt=""></li>
                                                        <li>Duration</li>
                                                        <li>3h 30 Min</li>
                                                    </ul>
                                                </div>
                                                <div class="btn-view">
                                                    <a class="btn view_btn" href="#">
                                                        <i class="fa fa-arrow-circle-o-down" aria-hidden="true"></i><span>View More</span></a>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>






                                <div class="clearfix"></div>
                            </div>
                        </div>
                        <!-- /col-12 -->
                        <!-- <div class="btn-save">
                          <input type="submit" value="submit" id="submit_ajaxs" class="btn save-delete3 btn-sub" />
                        </div> -->

                    </div>
                    <!-- /tab-pane-->

                    <!-- /users-->

                </div>
                <!-- /tab content-->

            </div>
        </div>
    </div>


    {% endblock %} {% block inpage_script %}

    <script src="https://d3js.org/d3.v4.min.js"></script>


    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script>
        $('#datepicker-default').datepicker({
            "dateFormat": "mm/dd/yy",
            'minDate': '+0d',
            'changeYear': 'true',
        });


        $('#id_logo').change(function() {

            var elm = this;

            if (elm.files && elm.files[0]) {

                var reader = new FileReader();

                reader.onload = function(e) {

                    $('.thumb_nail1 img')
                        .attr('src', e.target.result)
                        .width(200)
                        .height(150);
                };

                reader.readAsDataURL(elm.files[0]);
            }
        });



        //document.getElementById("certificate").innerHTML = document.getElementById("certificate").getAttribute("data-attr");

        var logourl = '';
        var bgurl = '';
        var sigurl = '';

        function readURL(input, is_background) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();

                reader.onload = function(e) {
                    doctorUrl1 = e.target.result;
                    if (is_background == false) {
                        //alert("logo");
                        appendDraggableImage(doctorUrl1, [50, 50], false);
                    } else if (is_background == true) {
                        //alert(reader.result);
                        // $('.certificate').css('background-image',"url(" + reader.result + ")");   
                        appendDraggableImage(doctorUrl1, [0, 0], true);
                    } else if (is_background == 'sig') {
                        appendDraggableImage(doctorUrl1, [500, 500], false);
                    } else {}
                    //$('#blah').attr('src', e.target.result);
                }
                reader.readAsDataURL(input.files[0]); // convert to base64 string
            }
        }

        $("#logo").change(function() {
            readURL(this, false);
        });

        $('#bi').change(function() {
            readURL(this, true);
        });

        $('#sig').change(function() {
            readURL(this, true);
        });

        var theInput = document.getElementById("favcolor");
        var bordercolor = document.getElementById("bordercolor");
        var theColor = theInput.value;
        var bordercolorvalue = bordercolor.value;

        //alert(bordercolorvalue);

        bordercolor.addEventListener("change", function() {
            bordercolorvalue = bordercolor.value;
            //alert(bordercolorvalue);
            $('.certificate').css('borderColor', bordercolorvalue);
            //alert(theColor);
        }, false);

        theInput.addEventListener("change", function() {
            theColor = theInput.value;
            //alert(theColor);
        }, false);


        $('#text').on('keyup', function(e) {
            //e.preventDefault();
            if (e.key === 'Enter' || e.keyCode === 13) {
                //e.preventDefault();
                var fonttype = $('#fonttype').find(":selected").text();
                var fontsize = $('#fontsize').find(":selected").text();
                //var c='';

                if (fonttype == undefined && fontsize == undefined) {
                    alert("please select font type and size");
                    return;
                }
                if (fonttype == "" && fontsize == "") {
                    alert("please select font type and size");
                    return;
                }
                var textv = $(this).val();
                // alert(textv);
                appendDraggableImage(textv, [100, 100], 'text', fonttype, fontsize);
                $(this).val('');

            }
        });
        $('#canname').on('keyup', function(e) {
            //e.preventDefault();
            if (e.key === 'Enter' || e.keyCode === 13) {
                //e.preventDefault();
                var fonttype = $('#fonttype').find(":selected").text();
                var fontsize = $('#fontsize').find(":selected").text();
                //var c='';

                if (fonttype == undefined && fontsize == undefined) {
                    alert("please select font type and size");
                    return;
                }
                if (fonttype == "" && fontsize == "") {
                    alert("please select font type and size");
                    return;
                }
                var textv = $(this).val();
                // alert(textv);
                appendDraggableImage(textv, [100, 100], 'canname', fonttype, fontsize);
            }
        });
    </script>


    <script>
        var id = "{{ obj.id }}";
        console.log(id);
        //var height = $('.certificate').attr("height");
        //var width = $('.certificate').attr("width");
        var zoom = d3.zoom();

        var svg = d3.select("div.certificate").append("svg")
            .attr("width", "780px")
            .attr("height", "580px")

        var image = {
            size: 150
        }

        var defs = svg.append("defs");


        // if(id)
        // {

        //     var svg=d3.select("svg");
        //     //console.log(svg);
        // }
        // else
        // {
        //   var svg = d3.select("div.certificate").append("svg")
        //   .attr("width", "780px")
        //   .attr("height", "580px")

        //   var image = {
        //     size: 150
        //   }

        //   var defs = svg.append("defs");
        // }

        // var clipPath = defs.append("clipPath")
        //   .attr("id", "clip")
        //   .append("circle")
        //   .attr("cx", image.size / 2)
        //   .attr("cy", image.size / 2)
        //   .attr("r", image.size / 2);

        // var glow = defs.append("filter")
        //   .attr("id", "glow");


        // glow.append("feGaussianBlur")
        //   .attr("class", "blur")
        //   .attr("stdDeviation", 3.5)
        //   .attr("result","coloredBlur");

        // var feMergeGlow = glow.append("feMerge");
        // feMergeGlow.append("feMergeNode")
        //   .attr("in","coloredBlur");
        // feMergeGlow.append("feMergeNode")
        //   .attr("in","SourceGraphic");

        function appendDraggableImage(url, position, is_background, fonttype, fontsize) {
            var imageGroup = svg.append("g")
                .datum({
                    position: position
                })
                .attr("transform", d => "translate(" + d.position + ")");

            if (is_background == "text") {
                //alert(position);
            }
            //alert("fjfjff");
            clsbtn1 = new d3CloseButton();
            var size = 100;
            //clsbtn1.size(30).isCircle(true).borderStrokeWidth(3).crossStrokeWidth(5);



            //alert(is_background);
            if (is_background == false) {
                //var imageELEM = imageGroup.append("div").css({position:position});
                var imageElem = imageGroup.append("image")
                    .attr("xlink:href", url)
                    .attr("height", image.size)
                    .attr("width", image.size);
                //imageELEM.append("div").attr("class","resizer top-left");
                // imageELEM.append("div").attr("class","resizer top-right");
                // imageELEM.append("div").attr("class","resizer bottom-left");
                // imageELEM.append("div").attr("class","resizer bottom-right");
                //.attr("class","top-left top-right bottom-left bottom-right")
                //.attr("clip-path", "url(#clip)");
            } else if (is_background == true) {
                //alert("going to here")
                var imageElem = imageGroup.append("image")
                    .attr("xlink:href", url)
                    .attr("height", "570")
                    .attr("width", "770")
                    .attr("background", true)
                    //.attr("clip-path", "url(#clip)");
            } else if (is_background == 'text') {
                fontsize = fontsize + "px";
                var theInput = document.getElementById("favcolor");
                var color = theInput.value;
                //alert(color);
                //alert(typeof(color));
                var fontstyle = $('#fontstyle').find(":selected").val();

                imageGroup.append("text").style("font-size", fontsize).style('fill', color).style("font-weight", fontstyle).style('font-family', fonttype).text(url).attr("text-anchor", "start").style('alignment-baseline', 'hanging');

                function type(d) {
                    return d;
                }

            } else if (is_background == 'canname') {
                fontsize = fontsize + "px";
                var theInput = document.getElementById("favcolor");
                var color = theInput.value;
                var fontstyle = $('#fontstyle').find(":selected").val();
                imageGroup.append("text").style("font-size", fontsize).
                style('fill', color).style("font-weight", fontstyle).
                style('font-family', 'Times New Roman').text(url).attr("id", "candidatename").
                attr("text-anchor", "start").style('alignment-baseline', 'hanging');
                // function type(d) {
                //   return d;
                // }

            }
            imageGroup.call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended));


            //selection.call(d3.zoom().on("zoom", zoomed));

            var zoom = d3.zoom().scaleExtent([0.5, 8]).on("zoom", zoomed);

            // imageGroup.call(d3.zoom().on('zoom',e=>{ 
            //       console.log("djfndefnjden");
            // }));

            imageGroup.call(zoom);



            imageGroup.each(function(d, i) {
                var g = d3.select(this);
                //console.log(d.position[0]);
                //g.attr("d",{})
                clsbtn1.x(d.position[0] / 12).y(3).isCircle(true).clickEvent(function() {
                    g.remove();
                });
                g.call(clsbtn1);
            });



        }

        function dragstarted(d) {
            //       d3.select(this).raise();    
            //       d3.select(this).select(".circle-outline")
            //        .transition()
            //        .attr("r", 1 + image.size / 3);
            //       d3.select(this).select(".circle-fill")
            //        .transition()
            //        .attr("r", 1 + image.size / 3);
            //       d3.select(this).select("image")
            //        .attr("x", image.size / 6)
            //        .attr("y", image.size / 6)
            //        .attr("height", image.size * 2 / 3)
            //         .attr("width", image.size * 2 / 3)
            //       clipPath.attr("r", image.size / 3)
        }

        function zoomed() {
            //console.log("succc");
            // parent.select("svg").attr("transform", d3.event.transform);
            //console.log(d.transform);
        }

        function dragged(d) {
            var newX = d3.event.x - image.size / 2,
                newY = d3.event.y - image.size / 2;

            d3.select(this)
                .attr("transform", "translate(" + (d.position = [newX, newY]) + ")");
        }

        function dragended(d) {
            d3.select(this).lower();

        }



        $('#submit_ajax').click(function(event) {
            event.preventDefault();
            var noc = $('#id_no_of_candidates').val();
            if (noc !== '') {
                if (noc <= 1) {
                    alert("no of candidate either will be blank or greater than 1");
                    return;
                }
            }


            var unique_code = $('#id_unique_code').val();
            if (unique_code == '') {
                alert("orgnization code should not be null");
                return;
            }

            var pass = $('#id_password').val();
            var pass_again = $('#id_password_again').val();
            if (pass == '') {
                alert("Password can not be blank");
                return;
            }
            if (pass != pass_again) {
                alert("Password and password again field value should match");
                return;

            }
            //d3.selectAll("#crossline").remove();
            //d3.selectAll("#crossbutton").remove();

            var gi = document.getElementById("certificate_upper");
            var div = document.createElement('div')
            div.style.display = "none";
            document.body.appendChild(div);
            //alert(gi);
            //alert(gi.getRootNode());
            html2canvas(gi).then(
                function(canvas) {
                    //document.getElementById('output').appendChild(canvas); 
                    alert("checking ...");
                    div.appendChild(canvas);
                    var imgData = canvas.toDataURL('image/png');
                    //  $.ajax({
                    //     url :'{% url "customadmin:save_org_cer_img" %}',
                    //     type:'post',
                    //     data:{'image':imgData},
                    //     success:function(data){
                    //       alert(data);
                    //     }
                    // });
                    var doc = new jsPDF('p', 'mm', 'a4');
                    doc.addImage(imgData, 'PNG', 0, 0);
                    doc.save('certificate.pdf');
                });
            //var certificate = document.getElementById("id_certificate");
            $('#id_certificate').val($("#certificate_upper").clone().html());


            $('#form_org').submit();



        });





        function d3CloseButton() {

            var size = 20,
                x = 0,
                y = 0,
                rx = 0,
                ry = 0,
                isCircle = false,
                isBorderShown = true,
                borderStrokeWidth = 1.5,
                crossStrokeWidth = 1.5,
                g,
                event;

            function button(selection) {

                //Styling for the border of the button
                var buttonStyle = {
                        "fill-opacity": 0,
                        "stroke-width": borderStrokeWidth,
                        "stroke": (isBorderShown) ? "none" : "black"
                    },
                    //for the cross
                    crossStyle = {
                        "stroke-width": crossStrokeWidth,
                        "stroke": "black"
                    },
                    r = size / 2,
                    ofs = size / 6,
                    cross;

                g = selection.append("g").on("click", event);
                cross = g.append("g");

                if (isCircle) {
                    g.append("circle")
                        .attr("cx", x)
                        .attr("cy", y)
                        .attr("r", r).attr("id", "crossbutton")
                        .style("fill-opacity", 0).
                    style("stroke-width", 1.5).style("stroke", "none");

                    cross.append("line")
                        .attr("x1", x - r + ofs)
                        .attr("y1", y)
                        .attr("x2", x + r - ofs)
                        .attr("y2", y).attr("id", "crossline");

                    cross.append("line")
                        .attr("x1", x)
                        .attr("y1", y - r + ofs)
                        .attr("x2", x)
                        .attr("y2", y + r - ofs).attr("id", "crossline");

                    // // Make '+' to 'x'
                    cross.attr("transform", "rotate (45," + x + "," + y + ")");
                    console.log(cross);

                } else {
                    g.append("rect")
                        .attr("x", x)
                        .attr("y", y)
                        .attr("rx", rx)
                        .attr("ry", ry)
                        .attr("width", size)
                        .attr("height", size)
                        .style(buttonStyle);

                    cross.append("line")
                        .attr("x1", x + ofs)
                        .attr("y1", y + ofs)
                        .attr("x2", (x + size) - ofs)
                        .attr("y2", (y + size) - ofs);

                    cross.append("line")
                        .attr("x1", (x + size) - ofs)
                        .attr("y1", y + ofs)
                        .attr("x2", x + ofs)
                        .attr("y2", (y + size) - ofs);
                }

                cross.style("stroke-width", 1.5).style("stroke", "black");

            }

            button.x = function(val) {
                x = val;
                return button;
            }

            button.y = function(val) {
                y = val;
                return button;
            }

            button.size = function(val) {
                size = val;
                return button;
            }

            button.rx = function(val) {
                rx = val;
                return button;
            }

            button.ry = function(val) {
                ry = val;
                return button;
            }

            button.borderStrokeWidth = function(val) {
                borderStrokeWidth = val;
                return button;
            }

            button.crossStrokeWidth = function(val) {
                crossStrokeWidth = val;
                return button;
            }

            //If true, the border of the button becomes a circle instead of a rectangle
            button.isCircle = function(val) {
                isCircle = val;
                return button;
            }

            button.isBorderShown = function(val) {
                isBorderShown = val;
                return button;
            }

            button.clickEvent = function(val) {
                event = val;
                return button;
            }

            //Remove the whole button if one already exists
            button.remove = function() {
                if (g) {
                    g.remove();
                    g = undefined;
                }
                return button;
            }

            return button;
        }
    </script>



    <!-- <script src='dist/jspdf.min.js' type='text/javascript'></script> -->

    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.5/dist/html2canvas.min.js">
    </script>





    {% endblock %}