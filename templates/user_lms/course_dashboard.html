{% extends 'user_lms/header_1.html' %}

{% block course_details %}

{% load static %}
<!-- {% get_media_prefix %} 
 -->
{% load mytag %}
{% load userlmstag %}

{{ object.about|json_script:'course_about' }} 
{{ object.id|json_script:'object_id' }} 
{{ object.highlights|json_script:'course_highlights' }}
{{ object.overview|json_script:'course_overview' }}




 <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat&display=swap');
.container-x {
    background-color: #fff;
    color: #333;
    border-radius: 10px;
    padding: 20px;
    font-family: 'Montserrat', sans-serif;
    max-width: 700px;
    border: 2px solid green;
}
.container-x>p {
    font-size: 32px
}
.question {
    width: 75%
}
.options {
    position: relative;
    padding-left: 40px
}
#options label {
    display: block;
    margin-bottom: 15px;
    font-size: 14px;
    cursor: pointer
}
#options > .options input {
    opacity: 0
}
.checkmark {
    position: absolute;
    top: -1px;
    left: 0;
    height: 25px;
    width: 25px;
    background-color: #fff;
    border: 1px solid #555;
    border-radius: 50%;
}
.options input:checked~.checkmark:after {
    display: block
}
.options .checkmark:after {
    content: "";
    width: 10px;
    height: 10px;
    display: block;
    background: white;
    position: absolute;
    top: 50%;
    left: 50%;
    border-radius: 50%;
    transform: translate(-50%, -50%) scale(0);
    transition: 300ms ease-in-out 0s;
}
.options input[type="radio"]:checked~.checkmark {
    background: #21bf73;
    transition: 300ms ease-in-out 0s
}
.options input[type="radio"]:checked~.checkmark:after {
    transform: translate(-50%, -50%) scale(1)
}
.options input[type="checkbox"]:checked~.checkmark {
    background: #21bf73;
    transition: 300ms ease-in-out 0s
}
.options input[type="checkbox"]:checked~.checkmark:after {
    transform: translate(-50%, -50%) scale(1)
}
.btn-primary-x {
    background-color: #555;
    color: #ddd;
    border: 1px solid #ddd
}
.btn-primary-x:hover {
    background-color: #21bf73;
    border: 1px solid #21bf73
}
.btn-success-x {
    padding: 5px 25px;
    background-color: #21bf73
}
@media(max-width:576px) {
    .question {
        width: 100%;
        word-spacing: 2px
    }
}
 </style>

<!-- <link href="{% static 'user_lms/css/forum.css' %}" /> -->

<section class="course-details">
	<div class="course-dashboard-cover row" style="margin: 0;">
		<div class="container pt-4 pb-1" style="min-height: 360px;">
			<div class="row">
				<div class="col-md-12">
					<h2 style="font-size:35px; font-weight: 600; font-family: sans-serif;">{{ object.name }}</h2>
				</div>
				<div oncontextmenu="return false;" class="col-md-8 col-sm-12 mt-1 p-0" style="float: left;height: 500px;border:1px black dotted">
					<div id="activity_box_area" style="width:100%; height:100%;">
						<!-- test..... -->
						<button class="screen-resize-btn" data-fullscreen="False" id="activity_screen_resize"><span class="fa fa-expand"></span>
							</button>
						<div class="row m-0" id="course-start" style="width:100%; height:100%;background-size:cover;
						background-repeat:no-repeat; background-image: url('{{ object.thumbnail.url }}');">
							<span style="background:rgba(0,0,0, 0.4);width:70px; height:70px;font-size:32px;padding-top:10px; padding-left:7px; text-align:center;
							position:absolute;top:45%; left:45%; border: 3px solid #fff; border-radius:50%; color:#fff;">
								<i class="fa fa-play"></i>
								
							</span>
						</div>
						<div class="row m-0" 
						id="activity_area" style="display:none;">
							<video id="my-player" style="display:none;"
							    controls
							    preload="auto"
								poster="{{ object.thumbnail.url }}"
							    data-setup='{}' webkit-playsinline="true"
    playsinline="true" muted="muted"  height="500px;">
							  <p class="vjs-no-js">
							    To view this video please enable JavaScript, and consider upgrading to a web browser that
							    <a href="https://videojs.com/html5-video-support/" target="_blank">
							      supports HTML5 video
							    </a>
							  </p>
							</video>


						</div>

						<div class="row m-0" id="spin_activity_area" style="display: none">

							
								<div class="col-md-6">
								      <div id="chart"></div>
								</div>

								<div class="col-md-6" style="">
									
							    <div id="question" style="margin-top:50px;">
							      <h3 id="questionheader" style="font-size:17px;"data-qid=""></h3>

							      <div class="options" style="padding:10px;">
							        <p style="list-style: none">
							          <input type="radio" name="op" data-aid="" id="op1">
							            <label id="label_op1" for="op1"></label> 
							            <br/>
							          <input type="radio" name="op"  data-aid="" id="op2">
							            <label id="label_op2" for="op2"></label>
							            <br/>
							          <input type="radio" name="op"  data-aid="" id="op3">
							          <label id="label_op3" for="op3"></label>
							          <br/>
							          <input type="radio" name="op" data-aid="" id="op4">
							            <label id="label_op4" for="op4"></label>
							            <br/>
							           </p>

							          <button class="btn btn-success" id="saveanswer" data-sid="" value="saveanswer">Save Answer</button>
							        
							      </div>
							    </div>
								</div>
							

						</div>

						<div class="m-0" id="quiz_activity_area" style="display: none; background:#ffffff;width:100%; height:100%; max-height:500px;overflow:auto;">
							<div class="row mx-0 py-4">
								<h3 style="width:100%; display:block; text-align:center;">Quiz Instructions and Rules</h3>
							</div>

	                        <div id="content" class="pmd-content inner-page row mx-0">
	                            <div class="container-fluid full-width-container data-tables">
	                                <section class="row component-section mx-0">
	                                    <div class="row mx-0" style="width:100%;">
	                                        <div class="row mx-0" style="width:100%;">
	                                            <div id="quiz-panel-body" style="width:100%;">

	                                            </div>
												<div id="quiz-play-body" style="display:none; width:100%;">

	                                            </div>
	                                        </div>
	                                    </div>
	                                </section>
	                            </div>
	                        </div>
						</div>

						<div id="assignment_activity_area" style="display: none;padding-top:200px;">
							<!-- <pre id="assignment_content" style="height:500px;width:inherit;"></pre>
							<object id="assignment_file_obj" style="height:500px;width:inherit;" data="" type="application/pdf">
	    					<embed src="" id="assignment_file" type="application/pdf" />
	    					</object> -->
	    					<center>
	    						<a style="" id="assignment_file_iframe" href="" target="_blank">Click To download Assignment</a>
	    						<br/>

	    						<p>
	    						   Please Submit File below After Assignment is complete 
	    						</p>
	    						<br/>

	    						&nbsp;&nbsp;&nbsp;

	    						<input type="file" data-attr="" name="assignment_file" 
	    						id="assignment_file" accept=".pdf,.doc,.docx" />
	    						<button class="btn btn-success" onclick="submit_assignment()"> Submit</button>
	    						
	    					</center>
	    					 <!--  <iframe id="assignment_file_iframe" frameborder="0" scrolling="no"
	    					 style="height:500px;width:100%;" 
	     					src="http://www.africau.edu/images/default/sample.pdf">
	  						</iframe> -->
						</div>

						<div id="drag_activity_area" style="display: none;">
							<div style="margin: 0px;"><h2 style="margin: 0px; text-align: center;" id="activity_title"></h2></div>

							  <div class="wrapper" id="activityPlayer" style="width:500px;">
							  </div>

						</div>
					</div>
				</div>
				<div class="col-md-4 col-sm-12 mt-1 px-2" style="float: left;">
				<div class="col-sm-12px-0" style="height: 500px;overflow-y: auto; background: #fff; box-shadow: 0px 0px 5px #00000066; border-radius:2px;margin-bottom:10px;">
					<div class="row m-0">
						<div class="fs-15 py-1 mx-2" style="width: 100%; display: block;">
							<div>
								<!-- <span>{{ content_length }} Lessons</span> -->
								<span class="fl-rt">Watch Time : {{ total_minute}} minutes {{ total_second }} seconds </span>
							</div>
						</div>



						{% for content,childs in all_content.items %}

							
						<br/>
						<div class="timeline mx-3" style="width: 100%; display: block;">

						{% if user.id|is_learningunit_open:content.id %}
						  <div class="fa timeline-container timeline-right">
						{% else %}
						<!-- <div class="fa timeline-container timeline-right"> -->
						  <div class="fa timeline-container-lock timeline-right">
						{% endif %}
					<!-- <i class="fa fa-lock" aria-hidden="true"></i> -->
						    <div class="content p-1" style="font-weight: 400;">
						      <h6 class="fw-800">{{ content.name }}</h6>
						     
						      <!-- {% for v in childs.video %}
								<div class="content p-1" style="">
									<a class="videoac" {% if user.id|is_video_open:v %} style="text-decoration:none;color:green" {% else %} style="text-decoration:none;" {% endif %}
									  topicid="{{content.id}}" videoid="{{v.id}}" atype="video" onClick="changevideo(this)" video-href="{{v.video}}">
											<i class="far fa-play-circle"></i>
											{{ v.description }}
										</a><!-<h6 class="fw-800"><i class="far fa-play-circle"></i> &nbsp;{{ v.description }}</h6> 
								</div>
							   {% endfor %} -->

							  {% for v in childs.activities %}
							  		 
							  		<div class="content p-1" style="">

							  		{% if v.activity_type == "video" %}

										<a class="videoac"  {% if user.id|is_activity_open:v.id %}style="color:green;" {% endif %}
										  topicid="{{content.id}}" activity_id="{{v.id}}" videoid="{{v.id}}" atype="video" onClick="changevideo(this)" video-href="{{ v.content_id }}">
												<i class="far fa-play-circle"></i>
												{{ v.activity_name }}
											</a>
										</div>

									{% elif v.activity_type == "quiz" %}

										<a {% if user.id|is_activity_open:v.id %}
										style="color:green;text-decoration: none;" {% else %} style="text-decoration:none;" {% endif %} target="_blank" class="show_quiz_activity" data-href="{% url 'assesment:start_quiz' v.content_id|get_questionpaper_id %}" activity_id="{{v.id}}"><i class="fas fa-question"></i>
												{{ v.activity_name }}</a>

									

									{% elif v.activity_type == "Assignment" %}
										<a {% if user.id|is_activity_open:v.id %}
										style="color:green;text-decoration: none;" {% else %} style="text-decoration:none;" {% endif %} target="_blank" data-href="{% url 'customadmin:spin_activity' v.content_id %}" data-attr="{{v.id}}" activity_id="{{v.id}}" class="show_assignment_activity" ><i class="fas fa-tasks"></i>
												{{ v.activity_name }}</a>

									{% elif v.activity_type == "spin_activity" %}
											
											<a {% if user.id|is_activity_open:v.id %}
										style="color:green;text-decoration: none;" {% else %} style="text-decoration:none;" {% endif %} target="_blank" data-href="{% url 'customadmin:spin_activity' v.content_id %}" data-attr="{{v.content_id}}" activity_id="{{v.id}}" class="show_spin_activity" ><i class="fas fa-spinner"></i>{{ v.activity_name }}</a>

									{% endif %}
									
							  {% endfor %}


						      
						    {% for subtopic,inside in childs.subtopic.items %}
						      		<div class="pl-2 py-1">
								      	<div class="py-1">
								      		<!-- <span class="far fa-check-circle"> -->
							{% if user.id|is_learningunit_open:subtopic.id %}
								      		<span class="far fa-check-circle">
								      			{{ subtopic.name }}
								      		</span>

							{% else %}
								    	<span class="fa fa-lock">
								      			{{ subtopic.name }}
								      		</span>
							{% endif %}
								      			
								      	</div>
								      	
								      	<div class="pl-4">

								      		{% for subact in inside.activities %}
								      				
								      			<div class="py-1">
										      	<span class="">
												    {% if subact.activity_type == "quiz" %}
												      		<i class="fas fa-question"></i>

												    {% elif subact.activity_type == "spin_activity" %}
												      		<i class="fas fa-spinner"></i>

												    {% elif subact.activity_type == "video" %}
												      		<i class="far fa-play-circle"></i>

												     {% elif subact.activity_type == "Assignment" %}
												      		<i class="fas fa-tasks"></i>
												    {% else %}
												      		<i class="fas fa-question"></i>
												    {% endif %}


												    

										{% if subact.activity_type == "quiz"  %}
										
								
										<!--<a style="text-decoration:none;color:green" target="_blank" href="{% url 'assesment:start_quiz' subact.content_id|get_questionpaper_id %}">{{ subact.activity_name }}</a>-->
											<a {% if user.id|is_activity_open:subact.id %}
										style="color:green;text-decoration: none;" {% else %} style="text-decoration:none;" {% endif %} target="_blank" class="show_quiz_activity" data-href="{% url 'assesment:start_quiz' subact.content_id|get_questionpaper_id %}" activity_id="{{subact.id}}">{{ subact.activity_name }}</a>

								
										{% elif subact.activity_type == "video" %}

											<a {% if user.id|is_activity_open:subact.id %}
										style="color:green;text-decoration: none;" {% else %} style="text-decoration:none;" {% endif %} target="_blank" topicid="{{subtopic.id}}" videoid="{{subact.id}}" atype="video" onClick="changevideo(this)" video-href="{{subact.content_id}}" activity_id="{{subact.id}}" class="video_activity">{{ subact.activity_name }}</a>


										{% elif subact.activity_type == "spin_activity" %}
											
											<a {% if user.id|is_activity_open:subact.id %}
										style="color:green;text-decoration: none;" {% else %} style="text-decoration:none;" {% endif %} target="_blank" data-href="{% url 'customadmin:spin_activity' subact.content_id %}" data-attr="{{subact.content_id}}" activity_id="{{subact.id}}" class="show_spin_activity" >{{ subact.activity_name }}</a>

										{% elif subact.activity_type == "Assignment" %}
											
											<a {% if user.id|is_activity_open:subact.id %}
										style="color:green;text-decoration: none;" {% else %} style="text-decoration:none;" {% endif %} target="_blank" data-href="{% url 'customadmin:spin_activity' subact.content_id %}" data-attr="{{subact.id}}" activity_id="{{subact.id}}" class="show_assignment_activity" >{{ subact.activity_name }}</a>

										{% elif subact.activity_type == "mcq" %}
											
											<a {% if user.id|is_activity_open:subact.id %}
										style="color:green;text-decoration: none;" {% else %} style="text-decoration:none;" {% endif %} target="_blank" data-href="{% url 'assesment:start_quiz' subact.content_id|get_questionpaper_id %}" activity_id="{{subact.id}}" class="open_popup">{{ subact.activity_name }}</a>

										{% elif subact.activity_type == "drag_and_drop" %}

											<a {% if user.id|is_activity_open:subact.id %}
										style="color:green;text-decoration: none;" {% else %} style="text-decoration:none;" {% endif %} target="_blank" data-href="{{subact.content_id}}" class="show_drag_activity">{{ subact.activity_name }}</a>

										{% else %}
												
										{{ subact.activity_name }}
												<!-- {{ subact.activity_type }} -->
										{% endif %}

								
										      	</span>
									      		
									      	</div>
									      	{% endfor %}

									    </div>
									   </div>


								   {% endfor %}
								      		
						      
						    </div>
						  </div>
						
					</div>
						
						  {% endfor %}
						 
						  
				</div>
				</div>
				</div>
			</div>
			<div class="clearfix"></div>
		</div>
	</div>

	<script>

		// $('.subtopic_video').click(function(){
		// 		alert();
		// });
	// document.getElementById('my-player_html5_api').addEventListener('contextmenu',event=>event.preventDefault());
	//document.addEventListener('contextmenu', event => event.preventDefault());
	 	


		function get_video(url){
			var xhr = new XMLHttpRequest();
				xhr.responseType = 'blob';

				xhr.onload = function() {
				  
				  var reader = new FileReader();
				  
				  reader.onloadend = function() {
				  
				    var byteCharacters = atob(reader.result.slice(reader.result.indexOf(',') + 1));
				    
				    var byteNumbers = new Array(byteCharacters.length);

				    for (var i = 0; i < byteCharacters.length; i++) {
				      byteNumbers[i] = byteCharacters.charCodeAt(i);
				    }
				    var byteArray = new Uint8Array(byteNumbers);
				    var blob = new Blob([byteArray], {type: 'video/ogg'});
				    var urls = URL.createObjectURL(blob);

				    
				    //document.getElementById('_video').src = url;
				    //$('.video-js video').attr('src', urls);
				    //$('.video-js video source').attr('src', urls);
					//$(".video-js")[0].load();
					$("#my-player_html5_api").css("display", "block");
					$("#my-player").addClass("video-js");
					var myPlayer = videojs('my-player');

					myPlayer.src({type: 'video/ogg','src': urls});
					myPlayer.options.autoplay = true;
					myPlayer.options.liveui = true;
					myPlayer.ready(function() {
						videoPlayerCondition(myPlayer);
						myPlayer.play();
					});
					 
				    
				  }
				  
				  reader.readAsDataURL(xhr.response);
				  
				};

				xhr.open('GET', url);
				xhr.send();




		}

		document.querySelector("#course-start").onclick = function(e){
			$("#course-start").hide();
			$('.timeline').find('a:first').trigger('click');
			console.log('x fs', $('.timeline').find('a:first').html());
		};


		var subtopicid,videoid,activityid;
		var changevideo=function changeVideo(param) {
			var subtopicid=$(param).attr('topicid');
			var activity_type=$(param).attr('atype');
			var videoid=$(param).attr('videoid');
			var activityid=$(param).attr('activityid');
			if(activity_type=="video")
			{
				
				$.ajax({
					url:'{% url "userlms:is_open" %}',
					type:'post',
					data: {'topic':subtopicid,'video':videoid},
					success:function(data){
						var res = JSON.parse(data)
						if(res.message==true)
						{
							//var video=$(param).attr("video-href");
							var video = res.video_href;
							var media_url ="{{ media_url }}";
							//alert(media_url);
							// $('.video-js video').attr('src', "{{ media_url }}"+video);
							$('#assignment_activity_area').hide();
							$('#drag_activity_area').hide();
							$('#quiz_activity_area').hide();
							$("#spin_activity_area").hide();
							$("#course-start").hide();
							$("#activity_area").show();
							$("#my-player").show();
							playerBtnSet();
							$('#my-player_html5_api').attr('topicid',subtopicid);
							$('#my-player_html5_api').attr('videoid',videoid);
								// $('.video-js video source').attr('src', "{{ media_url }}"+video);
								// $(".video-js")[0].load();
								get_video(video)
								
						}
						else{
							alert("module is locked");
						}

					}
				});
			}
			else
			{
				$.ajax({
					url:'{% url "userlms:is_open" %}',
					type:'post',
					data:{'topic':subtopicid,'video':activityid},
					success:function(data){
						
						if(data=="Yes"){
							var video=$(param).attr("video-href");
							var media_url ="{{ media_url }}";
							//alert(media_url);
							$('.video-js video').attr('src', "{{ media_url }}"+video);
						
								$('.video-js video source').attr('src', "{{ media_url }}"+video);
								$(".video-js")[0].load();
								//$('.video-js').show();
						}
						else{
							alert("module is locked");
						}

					}
				});
			}
		}

		// $('.video-js').onended = function() {
  //   		alert("The audio has ended");
		// };


</script>

	<div class="container py-4 px-0">
		<div class="col-md-12 col-sm-12 pl-0 pr-0">
			<div class="col-md-8 col-sm-12 px-0" style="float: left;">
				<div class="tabs">
					<div class="tab-heading px-3">
						<label class="course-overview px-3 brd-btm2 fs-20" style="font-weight: 600; font-family: sans-serif;" onclick="tabCourseTabChange(this, '#contentForWatchingLive')"> Watching Live</label>
						<label class="course-about px-4 fw-800 fs-20" style="font-weight: 600; font-family: sans-serif;" onclick="tabCourseTabChange(this, '#contentForNotes')"> Notes</label>
						<label class="course-about px-4 fw-800 fs-20" style="font-weight: 600; font-family: sans-serif;" onclick="tabCourseTabChange(this, '#contentForQA')"> Q&A</label>
						<label class="course-about px-4 fw-800 fs-20" style="font-weight: 600; font-family: sans-serif;" onclick="tabCourseTabChange(this, '#contentForAbout')"> About</label>
					</div>
					<div class="tab-content brd-rds-5" style="box-shadow: 0px 0px 15px #00000029;">
						<div id="contentForWatchingLive" style="height:300px;overflow-y: scroll; scrollbar-width: none;" class="px-5 py-4 fs-15 check-list">
							<!-- {% for obj in online %}
							<p><div class="row">
			                            	'<div class="col-md-2">
			                                	'<img src="{% static 'user_lms/img/user.png' %}" class="img-circle img-responsive" style="border-radius: 50%;" height="50" width="50"  alt="" />
			                            	</div><div class="col-md-10"><div class="mic-info"><a href="#"></a> </div> <div class="comment-text" style="float: right;margin-right:70px;"><button>Chat</button></div></div></div>
			                </p>
			                {% endfor %} -->

									
						</div>
						<div id="contentForNotes" style="height:300px;overflow-y: scroll; scrollbar-width: none;display: none;" class="px-5 py-4 fs-15" >
								 <div class="form-group">
	   							 <label for="notes">Please record all your notes here for future references </label>
	    							<textarea class="form-control" id="notes" name="notes" rows="3" placeholder="enter note">
	    								
	    							</textarea>
	    							

	  						    </div>
	  						    <!-- <input type="hidden" name="author" value="{{user.id}}" id="author_notes"/>
	    							<input type="hidden" name="course" value="{{object.id}}" id="author_course" /> -->

	  						    <div class="form-group" style="float: right">
	  						    	<button class="btn btn-success send_notes" >Submit</button>
	  						    </div> 

						</div>

						<div id="contentForQA" class="px-5 py-4 fs-15" style="display: none;height: 300px;overflow-y: scroll; scrollbar-width: none;">


				 <!-- <ul style="list-style:none !important;" class="fff"> -->

					{% for d in discussions %}
                    <p style="list-style:none" class="jgj">
                        <div class="row">
                            <div class="col-md-2">
                            	{% if d.author|get_image_url %}
                                <img src="{{d.author|get_image_url}}" class="img-circle img-responsive" width="50" height="50" alt="" style="border-radius:50%;" />
                                {% else %}
                                <img src="{% static 'user_lms/img/user.png' %}" class="img-circle img-responsive" width="50" height="50" alt="" style="border-radius:50%;" />
                                {% endif %}
                            	
                            </div>
                            <div class="col-md-10" style="float: right">
                                
                                    
                                    <div class="mic-info">
                                        By: <a href="#">
                                       {{ d.author|get_first_name }}</a>  &nbsp;&nbsp; {{d.created_date|date:'d/m/y h:m:s'}}
                                    </div>
                                
                                <div class="comment-text">
                                    {{ d.discuss }}
                                </div>
                                <!-- <div class="action">
                                    
                                    <button type="button" class="btn btn-danger btn-xs" title="Delete">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </div> -->
                            </div>
                        </div>
                    </p>
                    {% endfor %}
               <!--  </ul>
                	 -->
						<div class="input-group mb-3">
							  <input type="text" id="qa-discuss" class="form-control" placeholder="write your query"/>
							  <div class="input-group-append">
							    <button class="btn btn-success" id="qa-submit" type="button">Submit</button>
							  </div>
						</div>
<!-- <div class="be-comment-block" style="overflow: scroll">
	<h4 class="comments-title">Comments (3)</h4>
	<div class="be-comment" style="background: grey;padding:3px;border-radius: 3px;">
		<div class="be-img-comment">	
			<a href="blog-detail-2.html">
				<img src="https://bootdey.com/img/Content/avatar/avatar1.png" alt="" class="be-ava-comment" width="30" height="30">
			</a>
		</div>
		<div class="be-comment-content">
			
				<span class="be-comment-name">
					<a href="">Ravi Sah</a>
					</span>
				<span class="be-comment-time">
					<i class="fa fa-clock-o"></i>
					May 27, 2015 at 3:14am
				</span>

			<p class="be-comment-text">
				Pellentesque gravida tristique ultrices. 
				Sed blandit varius mauris, vel volutpat urna hendrerit id. 
				
			</p>
		</div>
	</div>
	
	
	<form>
		<div class="form-group">
	   		<label for="exampleFormControlTextarea1">
	   		Question:</label>

	   	</div>
		<input class="form-control" name="text" />
			
		<a class="btn btn-primary pull-right">submit</a>
		
	</form>
</div> -->

							
						</div>
						<div id="contentForAbout" class="px-5 py-4 fs-15" style="display: none;">

						</div>
					</div>
				</div>
			</div>
			<div class="col-md-4 col-sm-12 px-2" style="float: left;">
				<div class="brd-rds-5 px-3 pb-3" style="background: transparent linear-gradient(1deg, #F3E6E8 0%, #D7E1EC 100%) 0% 0% no-repeat padding-box; opacity: 1;border-radius: 5px;">
					<h6 style="text-align: center; padding: 5px;">Course Achievements</h6>

					<!--<div class="brd-rds-5" style="background: #fff;">
						<div class="fs-13 py-2" style="text-align: center;width:100%;">
							Badges
						</div>
						<div class="row mx-0 pb-2" style="width: 100%;">
							<div class="col-sm-4 px-1" style="float: left; text-align:center;">
								<img src="{% static 'user_lms/img/medal.png' %}" alt="badge image" class="img-responsive" />
							</div>
							<div class="col-sm-8 px-0" style="float: left;">
								<div class="py-2">
					    			<div>
					    				<span style="font-size:11px;color:#666;">Complete next module to earn your second badge</span>
					    			</div>
					    		<div class="mt-2 row mx-0">
					    			<div class="col-sm-1 px-0" style="font-size:11px;">
					    				<img src="{% static 'user_lms/img/course_badge.png' %}" alt="badge icon" />
					    				</div>
					    				<div class="col-sm-11 px-1">
						    				<div class="progress brd-rds-5 mt-1" style="height: 10px;">
											  <div class="progress-bar cta-color brd-green brd-rds-5" style="width: 20%; background: #28a745;" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>	
											</div>

											<div class="px-2 py-1" style="font-size:11px;">1 of 5 badges earned</div>
										</div>
					    			</div> 
					    		</div>
							</div>
						</div>
					</div>-->
					<!-- background: transparent linear-gradient(1deg, #F3E6E8 0%, #D7E1EC 100%) 0% 0% no-repeat padding-box; -->
					<div class="brd-rds-5 row my-2 mx-0 pb-2" style="background:white;opacity: 1;border-radius: 5px;margin-top:10px;">
						<div class="fs-13 py-2" style="text-align: center; width: 100%;">
							Certificates
						</div>
						<div class="col-sm-4 px-1" style="float: left; text-align: center;">
							{% if is_org_course  %}
								
							<a class="showcertificate"  data-toggle="modal"> <img  width="100px" height="100px" 
							id="certificate_s" src="{% static 'user_lms/img/certificate.svg' %}"
							 data-attr='{{ certificate|safe }}' />
								

							
							</a>

<!-- modal start -->
    <!-- modal end -->

							{% else %}
								<img src="{% static 'user_lms/img/certificate.svg' %}" alt="certificate image" class="img-responsive" />
							{% endif %}

						</div>




						<div class="col-sm-8 px-0" style="float: left;">
							<div class="py-2">
				    			<div>
				    				<span style="font-size:11px;color:#666;">Complete your course to get your certificate
				    				</span>
				    			</div>
				    			<div class="mt-2 row mx-0">
				    				<div class="col-sm-1 px-0" style="font-size:11px;margin-right:1px;">
				    					{{ percentage }}% 
				    				</div>
				    				<div class="col-sm-11 px-1" style="padding-left:2px;">
					    				<div class="progress brd-rds-5 mt-1" style="height: 10px;">
										  <div class="progress-bar cta-color brd-green brd-rds-5" style="width: {{ percentage }}%; background: #28a745;" role="progressbar" aria-valuenow="{{ percentage}}" aria-valuemin="0" aria-valuemax="100">
										  	
										  </div>	
										</div>
									</div>
				    			</div>
				    		</div>
						</div>



<!-- modal -->
						<div tabindex="-1" class="modal fade" id="cer-dialog" style="display: none;z-index:9999;" aria-hidden="true">
    <div class="modal-dialog modal-lg" >
                                  <div class="modal-content">
                                    <div class="modal-header bordered">
                                      <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
                                      <h5 class="pmd-card-title-text"> Organization Certificate</h5>
                                    </div>
                                    <div class="modal-body" style="width:800px;height:600px;">

                                      <div class="certificate_u">

                                        	
                     
                                       </div>

                                    </div>
        </div>
      </div>
    </div>


						
					</div>
				</div>
			</div>
		</div>
		<div class="clearfix"></div>
	</div>

	

		<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> -->

		<script type="text/javascript">
			function tabCourseTabChange(t, id){
				$(t).siblings('label').removeClass('brd-btm2');
				$(t).addClass('brd-btm2');
				$(""+id).siblings('div').css('display', 'none');
				$(""+id).css('display', 'block');
			}
		</script>
</section>


<section class="courses-offered container">
	<div class="pt-4 pb-3" >
		<h4 style="text-align:center;font-family:sans-serif; 
		font-weight: 800;">Recommended/Searched based</h4>
		<br>
	</div>
	<div id="recommended_courses" class="carousel slide carousel-multi-item px-5 row mx-0" data-ride="carousel">
	  
		<div class="carousel-inner" role="listbox">

		    <!--First slide-->
		    <div class="carousel-item active">

		      	<div class="col-md-3 pop-card" style="float:left">

		        	<div class="card my-2 py-1 px-1 brd-green brd-rds-5">
		      			<div class="card-inner">
		      				<img src="{% static 'user_lms/img/f.png' %}" style="height:125px; width:175px;">

		      				<div class="card-inner-content">
		      				<div class="card-course-name">
		      					<label class="cc-name">Retail Sales Associate</label>
		      				</div>
		      					<div class="card-course-price">
		      						<span>
		      							<strike class="card-course-price-strike">Rs. 200.0</strike>
		      						</span> Free
		      					</div>
		      					<div class="fs-13 brd-btm brd-gry">
		      						<label class="card-course-rating-star">
		      							<!-- <i class="material-icons fs-15" aria-hidden="true">star</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star_half</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star_outline</i> -->
		      							(New)
		      						</label>
		      						<span class="card-enroll-count fl-rt">
		      							<i class="fa fa-users" aria-hidden="true"></i>
		      							0
		      						</span>
		      					</div>
		      					<div class="fs-13 py-2">
		      						<div style="max-height: 120px; min-height: 120px; overflow: hidden;">
		      							<b>Program Highlight</b><br> 
		      							<div class="p-highlight">
		      								<p style="margin-bottom: 0px;">Designed for Entry Level Job Force</p>
											<p style="margin-bottom: 0px;">Self-Paced Learning for Career Enhancement and Growth</p>
											<p style="margin-bottom: 0px;">Industry Relevant Curriculum with Latest Trends</p>
											<p style="margin-bottom: 0px;">Job Placement Assistance</p>
											<p style="margin-bottom: 0px;">Joint Certification with Retailers Association’s Skill Council of India</p>
										</div>
		      						</div>
		      					</div>
		      					<div>
		      						<button class="cta-btn btn-wdth-120 fs-13" onclick="refToLink('https://learning.apprentissage.in/course/view.php?id=12')">Enroll Now</button>
								
		      						<span class="fav-not fl-rt">
		      							<i class="fa fa-heart" aria-hidden="true"></i>
		      						</span>
		      					</div>
		      				</div>
		      			</div>
		      		</div>
		      		
		      		<div class="pop-card-hover" style="z-index:9;position: absolute; top:10px; left:210px;padding-left:20px;">
		      			<a href="" class="a-norm">
				      		<div class="fs-13 px-2 py-2 brd-rds-5" style="box-shadow: 10px 10px 15px #00000029;width:300px;background:#fff;">
				      			<h6 class="fs-15">Retail Sales Associate</h6>
				      			<!-- <p  class="brd-btm brd-gry" style="font-size: 11px;"> Total Video minute 200</p> -->
				      			<p class="brd-btm brd-gry py-1">What you will learn in this course</p>
				      			<div class="check-list" style="max-height: 240px; min-height:240px; overflow: hidden;">
					      			<ul class="c-overview p-2" style="list-style-type: none;">
										<ul style="list-style-type: none;">
											<li>Kickstart a career with fastest growing sector in India i.e. Retail Store Operations. Earn a certificate at the end of the program along with job placement assistance.</li>
											<li>Learn about interaction with customers, by giving specialized services and product demonstration.</li>
										</ul>
									</ul>
								</div>
								<div class="card-course-price txt-center py-1">
			  						<span>
			  							<strike class="card-course-price-strike fw-800" style="color: #bbb;">Rs. 200.0</strike>
			  						</span> Free
			  					</div>
			  					<div>

				  					<button style="min-width:200px;" data-href="5" class="cta-btn fs-13">View Details &nbsp;<i class="fa fa-arrow-right" aria-hidden="true"></i></button>
			  						<span class="fav-not fl-rt">
			  							<i class="fa fa-heart" aria-hidden="true"></i>
			  						</span>
			  					</div>
				      		</div>
				      	</a>
			      	</div>
		      	</div>
		      	<div class="col-md-3 pop-card" style="float:left">
		        	<div class="card my-2 py-1 px-1 brd-green brd-rds-5">
		      			<div class="card-inner">
		      				<img src="{% static 'user_lms/img/f.png' %}" style="height:125px; width:175px;">
		      				<div class="card-inner-content">
		      					<div class="card-course-name"><label class="cc-name">Retail Sales Associate</label></div>
		      					<div class="card-course-price">
		      						<span>
		      							<strike class="card-course-price-strike">Rs. 200.0</strike>
		      						</span> Free
		      					</div>
		      					<div class="fs-13 brd-btm brd-gry">
		      						<label class="card-course-rating-star">
		      							<!-- <i class="material-icons fs-15" aria-hidden="true">star</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star_half</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star_outline</i> -->
		      							(New)
		      						</label>
		      						<span class="card-enroll-count fl-rt">
		      							<i class="fa fa-users" aria-hidden="true"></i>
		      							0
		      						</span>
		      					</div>
		      					<div class="fs-13 py-2">
		      						<div style="max-height: 120px; min-height: 120px; overflow: hidden;">
		      							<b>Program Highlight</b><br> 
		      							<div class="p-highlight">
		      								<p style="margin-bottom: 0px;">Designed for Entry Level Job Force</p>
											<p style="margin-bottom: 0px;">Self-Paced Learning for Career Enhancement and Growth</p>
											<p style="margin-bottom: 0px;">Industry Relevant Curriculum with Latest Trends</p>
											<p style="margin-bottom: 0px;">Job Placement Assistance</p>
											<p style="margin-bottom: 0px;">Joint with Retailers Association’s Skill Council of India</p>
										</div>
		      						</div>
		      					</div>
		      					<div>
		      						<button class="cta-btn btn-wdth-120 fs-13" onclick="refToLink('https://learning.apprentissage.in/course/view.php?id=12')">Enroll Now</button>
								
		      						<span class="fav-not fl-rt">
		      							<i class="fa fa-heart" aria-hidden="true"></i>
		      						</span>
		      					</div>
		      				</div>
		      			</div>
		      		</div>
		      		<div class="pop-card-hover" style="z-index:9;position: absolute; top:10px; left:210px;padding-left:20px;">
		      			<a href="" class="a-norm">
				      		<div class="fs-13 px-2 py-2 brd-rds-5" style="box-shadow: 10px 10px 15px #00000029;  width:300px;background:#fff;">
				      			<h6 class="fs-15">Retail Sales Associate</h6>
				      			<!-- <p  class="brd-btm brd-gry" style="font-size: 11px;"> Total Video minute 200</p> -->
				      			<p class="brd-btm brd-gry py-1">What you will learn in this course</p>
				      			<div class="check-list" style="max-height: 240px; min-height:240px; overflow: hidden;">
					      			<ul class="c-overview p-2" style="list-style-type: none;">
										<ul style="list-style-type: none;">
											<li>Kickstart a career with fastest growing sector in India i.e. Retail Store Operations. Earn a  at the end of the program along with job placement assistance.</li>
											<li>Learn about interaction with customers, by giving specialized services and product demonstration.</li>
										</ul>
									</ul>
								</div>
								<div class="card-course-price txt-center py-1">
			  						<span>
			  							<strike class="card-course-price-strike fw-800" style="color: #bbb;">Rs. 200.0</strike>
			  						</span> Free
			  					</div>
			  					<div>

				  					<button style="min-width:200px;" data-href="5" class="cta-btn fs-13">View Details &nbsp;<i class="fa fa-arrow-right" aria-hidden="true"></i></button>
			  						<span class="fav-not fl-rt">
			  							<i class="fa fa-heart" aria-hidden="true"></i>
			  						</span>
			  					</div>
				      		</div>
				      	</a>
			      	</div>
		      	</div>
		      	<div class="col-md-3 pop-card" style="float:left">
		        	<div class="card my-2 py-1 px-1 brd-green brd-rds-5">
		      			<div class="card-inner">
		      				<img src="{% static 'user_lms/img/f.png' %}" style="height:125px; width:175px;">
		      				<div class="card-inner-content">
		      					<div class="card-course-name"><label class="cc-name">Retail Sales Associate</label></div>
		      					<div class="card-course-price">
		      						<span>
		      							<strike class="card-course-price-strike">Rs. 200.0</strike>
		      						</span> Free
		      					</div>
		      					<div class="fs-13 brd-btm brd-gry">
		      						<label class="card-course-rating-star">
		      							<!-- <i class="material-icons fs-15" aria-hidden="true">star</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star_half</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star_outline</i> -->
		      							(New)
		      						</label>
		      						<span class="card-enroll-count fl-rt">
		      							<i class="fa fa-users" aria-hidden="true"></i>
		      							0
		      						</span>
		      					</div>
		      					<div class="fs-13 py-2">
		      						<div style="max-height: 120px; min-height: 120px; overflow: hidden;">
		      							<b>Program Highlight</b><br> 
		      							<div class="p-highlight">
		      								<p style="margin-bottom: 0px;">Designed for Entry Level Job Force</p>
											<p style="margin-bottom: 0px;">Self-Paced Learning for Career Enhancement and Growth</p>
											<p style="margin-bottom: 0px;">Industry Relevant Curriculum with Latest Trends</p>
											<p style="margin-bottom: 0px;">Job Placement Assistance</p>
											<p style="margin-bottom: 0px;">Joint  with Retailers Association’s Skill Council of India</p>
										</div>
		      						</div>
		      					</div>
		      					<div>
		      						<button class="cta-btn btn-wdth-120 fs-13" onclick="refToLink('https://learning.apprentissage.in/course/view.php?id=12')">Enroll Now</button>
								
		      						<span class="fav-not fl-rt">
		      							<i class="fa fa-heart" aria-hidden="true"></i>
		      						</span>
		      					</div>
		      				</div>
		      			</div>
		      		</div>
		      		<div class="pop-card-hover" style="z-index:9;position: absolute; top:10px; left:210px;padding-left:20px;">
		      			<a href="" class="a-norm">
				      		<div class="fs-13 px-2 py-2 brd-rds-5" style="box-shadow: 10px 10px 15px #00000029;  width:300px;background:#fff;">
				      			<h6 class="fs-15">Retail Sales Associate</h6>
				      			<!-- <p  class="brd-btm brd-gry" style="font-size: 11px;"> Total Video minute 200</p> -->
				      			<p class="brd-btm brd-gry py-1">What you will learn in this course</p>
				      			<div class="check-list" style="max-height: 240px; min-height:240px; overflow: hidden;">
					      			<ul class="c-overview p-2" style="list-style-type: none;">
										<ul style="list-style-type: none;">
											<li>Kickstart a career with fastest growing sector in India i.e. Retail Store Operations. Earn a at the end of the program along with job placement assistance.</li>
											<li>Learn about interaction with customers, by giving specialized services and product demonstration.</li>
										</ul>
									</ul>
								</div>
								<div class="card-course-price txt-center py-1">
			  						<span>
			  							<strike class="card-course-price-strike fw-800" style="color: #bbb;">Rs. 200.0</strike>
			  						</span> Free
			  					</div>
			  					<div>

				  					<button style="min-width:200px;" data-href="5" class="cta-btn fs-13">View Details &nbsp;<i class="fa fa-arrow-right" aria-hidden="true"></i></button>
			  						<span class="fav-not fl-rt">
			  							<i class="fa fa-heart" aria-hidden="true"></i>
			  						</span>
			  					</div>
				      		</div>
				      	</a>
			      	</div>
		      	</div>
		      	<div class="col-md-3 pop-card" style="float:left">
		        	<div class="card my-2 py-1 px-1 brd-green brd-rds-5">
		      			<div class="card-inner">
		      				<img src="{% static 'user_lms/img/f.png' %}" style="height:125px; width:175px;">
		      				<div class="card-inner-content">
		      					<div class="card-course-name"><label class="cc-name">Retail Sales Associate</label></div>
		      					<div class="card-course-price">
		      						<span>
		      							<strike class="card-course-price-strike">Rs. 200.0</strike>
		      						</span> Free
		      					</div>
		      					<div class="fs-13 brd-btm brd-gry">
		      						<label class="card-course-rating-star">
		      							<!-- <i class="material-icons fs-15" aria-hidden="true">star</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star_half</i>
		      							<i class="material-icons fs-15" aria-hidden="true">star_outline</i> -->
		      							(New)
		      						</label>
		      						<span class="card-enroll-count fl-rt">
		      							<i class="fa fa-users" aria-hidden="true"></i>
		      							0
		      						</span>
		      					</div>
		      					<div class="fs-13 py-2">
		      						<div style="max-height: 120px; min-height: 120px; overflow: hidden;">
		      							<b>Program Highlight</b><br> 
		      							<div class="p-highlight">
		      								<p style="margin-bottom: 0px;">Designed for Entry Level Job Force</p>
											<p style="margin-bottom: 0px;">Self-Paced Learning for Career Enhancement and Growth</p>
											<p style="margin-bottom: 0px;">Industry Relevant Curriculum with Latest Trends</p>
											<p style="margin-bottom: 0px;">Job Placement Assistance</p>
											<p style="margin-bottom: 0px;">Joint  with Retailers Association’s Skill Council of India</p>
										</div>
		      						</div>
		      					</div>
		      					<div>
		      						<button class="cta-btn btn-wdth-120 fs-13" onclick="refToLink('https://learning.apprentissage.in/course/view.php?id=12')">Enroll Now</button>
								
		      						<span class="fav-not fl-rt">
		      							<i class="fa fa-heart" aria-hidden="true"></i>
		      						</span>
		      					</div>
		      				</div>
		      			</div>
		      		</div>
		      		<div class="pop-card-hover" style="z-index:9;position: absolute; top:10px; left:210px;padding-left:20px;">
		      			<a href="" class="a-norm">
				      		<div class="fs-13 px-2 py-2 brd-rds-5" style="box-shadow: 10px 10px 15px #00000029;  width:300px;background:#fff;">
				      			<h6 class="fs-15">Retail Sales Associate</h6>
				      			<!-- <p  class="brd-btm brd-gry" style="font-size: 11px;"> Total Video minute 200</p> -->
				      			<p class="brd-btm brd-gry py-1">What you will learn in this course</p>
				      			<div class="check-list" style="max-height: 240px; min-height:240px; overflow: hidden;">
					      			<ul class="c-overview p-2" style="list-style-type: none;">
										<ul style="list-style-type: none;">
											<li>Kickstart a career with fastest growing sector in India i.e. Retail Store Operations. Earn a  at the end of the program along with job placement assistance.</li>
											<li>Learn about interaction with customers, by giving specialized services and product demonstration.</li>
										</ul>
									</ul>
								</div>
							<div class="card-course-price txt-center py-1">
			  						<span>
			  							<strike class="card-course-price-strike fw-800" style="color: #bbb;">Rs. 200.0</strike>
			  						</span> Free
			  					</div>
			  					<div>

				  					<button style="min-width:200px;" data-href="5" class="cta-btn fs-13">View Details &nbsp;<i class="fa fa-arrow-right" aria-hidden="true"></i></button>
			  						<span class="fav-not fl-rt">
			  							<i class="fa fa-heart" aria-hidden="true"></i>
			  						</span>
			  					</div>
				      		</div>
				      	</a>
			      	</div>
		      	</div>
		      	
		      	
		    </div> 

		    <div class="carousel-item">
		    
		      	
		      
		      	
		      	
		    </div>
		      	

		</div>
		    
		<a class="carousel-control-prev cta-color" style="opacity: 1 !important; width:40px;"  href="#recommended_courses" role="button" data-slide="prev">
	      <span style="font-weight: 800;" class="fa fa-chevron-circle-left fs-24" aria-hidden="true"></span>
	      <span class="sr-only">Previous</span>
	    </a>
	    <a class="carousel-control-next cta-color" style="opacity: 1 !important; width:40px;"  href="#recommended_courses" role="button" data-slide="next">
	      <span style="font-weight: 800;" class="fa fa-chevron-circle-right fs-24" aria-hidden="true"></span>
	      <span class="sr-only">Next</span>
	    </a>
	</div>
	<div class="clearfix"></div>


	
</section>

<style>

.chat-list {
    padding: 0;
    font-size: .8rem;
}

.chat-list li {
    margin-bottom: 10px;
    overflow: auto;
    color: #ffffff;
}

.chat-list .chat-img {
    float: left;
    width: 48px;
}

.chat-list .chat-img img {
    -webkit-border-radius: 50px;
    -moz-border-radius: 50px;
    border-radius: 50px;
    width: 100%;
}

.chat-list .chat-message {
    -webkit-border-radius: 50px;
    -moz-border-radius: 50px;
    border-radius: 50px;
    background: #5a99ee;
    display: inline-block;
    padding: 10px 20px;
    position: relative;
}

.chat-list .chat-message:before {
    content: "";
    position: absolute;
    top: 15px;
    width: 0;
    height: 0;
}

.chat-list .chat-message h5 {
    margin: 0 0 5px 0;
    font-weight: 600;
    line-height: 100%;
    font-size: .9rem;
}

.chat-list .chat-message p {
    line-height: 18px;
    margin: 0;
    padding: 0;
}

.chat-list .chat-body {
    margin-left: 20px;
    float: left;
    width: 70%;
}

.chat-list .in .chat-message:before {
    left: -12px;
    border-bottom: 20px solid transparent;
    border-right: 20px solid #5a99ee;
}

.chat-list .out .chat-img {
    float: right;
}

.chat-list .out .chat-body {
    float: right;
    margin-right: 20px;
    text-align: right;
}

.chat-list .out .chat-message {
    background: #fc6d4c;
}

.chat-list .out .chat-message:before {
    right: -12px;
    border-bottom: 20px solid transparent;
    border-left: 20px solid #fc6d4c;
}

.card .card-header:first-child {
    -webkit-border-radius: 0.3rem 0.3rem 0 0;
    -moz-border-radius: 0.3rem 0.3rem 0 0;
    border-radius: 0.3rem 0.3rem 0 0;
}


</style>
<!-- aria-labelledby="exampleModalLabel" aria-hidden="true" -->
<div class="modal fade" id="chatModal" tabindex="-1" role="dialog">
         <div class="modal-dialog modal-lg modal-dialog-centered">
           <div class="modal-content">
             <div class="modal-header">
               <h5 class="modal-title" id="chatmodaltitle">Chat</h5>
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
		          <span aria-hidden="true">&times;</span>
		        </button>
             </div>
           <div class="modal-body">
            <div class="container content">
    			<div class="row">
       			<div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
        			<p id="chatpmessage" class="chatpmessage" style="height:100%;width:100%;">
        			</p>

        			<!-- <ul class="chat-list" style="float:left;">
        				<li class="in">
        					<div class="chat-img">
        					 <img alt="Avtar" src="https://bootdey.com/img/Content/avatar/avatar1.png" width="50" height="40" 
        							>
        					</div>
        					<div class="chat-body" style="margin-left: 20px;float: left; width: 70%;">
        						<div class="chat-message" >
        							 <h5>Jimmy Willams</h5> 
        							<p id="chatpmessage" class="chatpmessage">
        							</p>
        						</div>
        					</div>
        				</li>


        			</ul>  -->
        		</div>
        	</div>
        </div>
        <div class="modal-footer">
        <input type="text" class="form-control" name="chattext" id="chattext" />
        <button id="chattextsubmit" class="btn btn-success">Send</button>
      </div>
           </div>
         </div>
</div>
</div>

<!-- Modal -->
  <div class="modal" id="upload_alert" >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" id="myModalLabel">File not selected</h4>
        </div>
        <div id = "modal_body"class="modal-body">
            <font color="brown"><b>Kindly attach a file and then click upload.</b></font>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
        </div>
      </div>
    </div>
  </div>

 <!-- UNDO CHANGES Modal -->
  <div class="modal" id="undo_changes" >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" id="myModalLabel">Are you Sure?</h4>
        </div>
        <div id = "modal_body"class="modal-body">
            <font color="brown"><b>Your code will be reset.</b></font>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-warning" onclick="reset_editor()">OK</button>
          <button type="button" class="btn btn-primary" data-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
  </div>

{% endblock %}






{% block inpage_script %}
	{% load static %}


	<script src="{% static 'user_lms/js/d3.js' %}" charset="utf-8"></script>
	
	<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script> -->

	<script src="{% static 'user_lms/js/html2canvas.js' %}"></script>

	<script>
		//import html2canvas from 'html2canvas';


		var object_id = JSON.parse(document.getElementById('object_id').textContent);

		$(document).ready(function(){
			
			$.ajax({
					url:'{% url "userlms:get_last_opened_topic" %}',
					type:'post',
					data: {'courseid':object_id},
					success:function(data){
						var res = JSON.parse(data);
						var activity_id=res.activity;
						var activity_type = res.activity_type;
						$('a[activity_id="'+activity_id+'"]').click();
						// if(activity_type == "spin_activity")
						// {
						// 	$('a[activity_id="'+activity_id+'"]').click();
						// }
						// if(activity_type == "video"){
						// 	$('a[activity_id="'+activity_id+'"]').click();
						// }

				}
			});
		});

		function domNodeToString(domNode) 
		{
			var element = document.createElement("div");
			element.appendChild(domNode);
			return element.innerHTML;
		}

		

			var attr=$('#certificate_s').attr("data-attr");
			$('.certificate_u').html(attr);
			$('.certificate_u').css("width","780px");
			$('.certificate_u').css("height","580px");
			$('.certificate_u > div#certificate').css("width","780px");
			$('.certificate_u > div#certificate').css("height","580px");
			d3.selectAll('g').select("#candidatename").text("{{ first_name }}{{last_name}}").attr("cx","490").attr("cy","300");

			d3.select('.certificate_u > div#certificate > svg').append("g").append("text")
    		.attr("x", -130)
    		.attr("y", 500)
    		.attr("dy", ".35em")
    		.style("font", "104px times")
    		.attr("fill", "#8cb4cd")
    		.attr('transform', 'rotate(-45)')
    		//.attr("transform",'translate(100,-200)')
    		.text("sample copy");

		// $svg_var = $('.certificate_u > div#certificate svg');
		// //$svg_var = d3.select(".certificate_u svg").childNodes;
		// console.log($svg_var);
		// var svgString = domNodeToString($svg_var.node());
		// //var svgString ='';
		// var image = new Image();
		// var svgBlob = new Blob([svgString], { type: "image/svg+xml;charset=utf-8" });

		// console.log(image);

		// var DOMURL = window.URL || window.webkitURL || window;
		// var url = DOMURL.createObjectURL(svgBlob);

		// var canvas = d3.select("#certificate_s").append("canvas")
		// 	.attr("width","100px")
		// 	.attr("height", "100px");

		// var context = canvas.node().getContext("2d");

		// image.onload = function() {
		// 	context.drawImage(image, 0, 0);
		// 	DOMURL.revokeObjectURL(url);
		// }

		// image.src = url;

		$('.showcertificate').click(function(){
			//alert();
			$('#cer-dialog').modal('show');
			
		});


		// var attr=$('#certificate_s').attr("data-attr");
		// //$('#certificate_s').html(attr);
		// var div=document.createElement('div')
  //       div.style.display="none";
  //       div.style.width="780px";
  //       div.style.height="600px";
  //       document.body.appendChild(div);
  //       div.innerHTML=attr;
  //       //console.log(div);
		// html2canvas(div).then( 
  //           function (canvas) 
  //           { 
  //               //div.appendChild(canvas);
  //               var imgData = canvas.toDataURL('image/png');
  //               $('#certificate_s').attr("src",imgData);
  //           }
  //       );



		//console.log($('#certificate > div#certificate'));
		// $('#certificate_s > div#certificate').css("width","100px");
		// $('#certificate_s > div#certificate').css("height","100px");
		// d3.select('svg').attr("height","100px");
		// d3.select('svg').attr("width","100px");
		// d3.selectAll('g').selectAll('image').attr("width","10px").attr("height","10px");
		// d3.selectAll('g').selectAll('text').attr("width","5px").attr("height","5px");
		// //$('#certificate > div#certificate > svg').attr("height","100px");
		//$('#certificate > div#certificate > svg').attr("width","100px");
		// $('#certificate > svg').children()
		//$('#certificate').css('width','100px');
		//$('#certificate').css('height','100px');
		// var svg=d3.select("svg");
		// console.log(svg);
		// svg.width="100px";
		// svg.height="100px";

		// $('.chatmodalopen').click(function(){
 		//        alert();
 		//        $('#chatModal').modal('show');
		//    });
	</script>
	<script>

		var padding = {top:20, right:40, bottom:0, left:0},
            w = 350 - padding.left - padding.right,
            h = 350 - padding.top  - padding.bottom,
            r = Math.min(w, h)/2,
            rotation = 0,
            oldrotation = 0,
            picked = 100000,
            oldpick = [],
            color = d3.scale.category20();
	        var data = [
	                {"label":"Dell LAPTOP",  "value":1,  "question":["What CSS property is used for specifying the area between the content and its border?","ddddd","ddwdw"]}, 
	                {"label":"DeTOP",  "value":1,  "question":["What CSS property is used for specifying the area between the content and its border?","ddd","sdjcbejb"]}, 
	                
	        ];
        
	    //var container ="";
	    var svg=null;
        var container = null;
        var data=null;
        var vis=null;
        //var oldpick = null;
        function spin(d)
        {

        	data = spin_data ;
        	$("input[name='op']").prop('checked', false);
	        	console.log("OldPick: " + oldpick.length, "Data length: " + data.length);
		        if(oldpick.length == data.length)
		        {
		            //console.log("done");
		        }
		        var ps= 360/data.length
		        pieslice = Math.round(1440/data.length)
		        rng      = Math.floor((Math.random() * 1440) + 360);
		        rotation = (Math.round(rng / ps) * ps); 
		        picked = Math.round(data.length - (rotation % 360)/ps);
		        picked = picked >= data.length ? (picked % data.length) : picked;
		        console.log('picked is'+picked);
		        console.log('oldpick is '+oldpick)
		        if(oldpick.indexOf(picked) !== -1)
		        {
		            d3.select(this).call(spin);
		            return;
		        } 
		        else 
		        {
		        }
	            rotation += 90 - Math.round(ps/2);
	            vis.transition().duration(3000).attrTween("transform", rotTween)
	                .each("end", function(){
	                    d3.select("#question h3").text('Question: '+data[picked].question[0].q);
	                  	$("#questionheader").attr('data-qid',data[picked].question[0].qid);

                    $('#op1').show();
                    $('#op2').show();
                    $('#op3').show();
                    $('#op4').show();
                    $('#saveanswer').show();
                    $('#op1').val(data[picked].question[0].op1);
                    $('#label_op1').text(data[picked].question[0].op1);

                    $('#op2').val(data[picked].question[0].op2);
                    $('#label_op2').text(data[picked].question[0].op2);

                    $('#op3').val(data[picked].question[0].op3);
                    $('#label_op3').text(data[picked].question[0].op3);

                    $('#op4').val(data[picked].question[0].op4);
                    $('#label_op4').text(data[picked].question[0].op4);

                    data[picked].question.shift();
                    console.log('que is'+data[picked].question);
                    $('#spin_questions').show();
                    if(data[picked].question.length < 1)
                    {
                      d3.select(".slice:nth-child(" + (picked + 1) + ") path")
					//   spin black colour...........................

                    //    .attr("fill", "#111");
					      .style({"opacity":"0.5"});
					
						
					 


                      console.log("done with "+picked);
                      oldpick.push(picked);
                    }
                    oldrotation = rotation;
                    
                    //container.on("click", spin);
                });

        }

 	 	//     var dataStore = (function(url){
  		//   			var spin_data;

			    

		// 	    return {getSpinData : function()
		// 	    {
		// 	        if (spin_data) return spin_data;
		// 	        // else show some error that it isn't loaded yet;
		// 	    }};
		// });


        //var data = $(dataStore.getSpinData());
        function create_spin(data)
        {
        	//console.log("datA",data);
	        svg = d3.select('#chart')
	            .append("svg")
	            .data([spin_data])
	            .attr("width",  w + padding.left + padding.right)
	            .attr("height", h + padding.top + padding.bottom);

	        container = svg.append("g")
	            .attr("class", "chartholder")
	            .attr("transform", "translate(" + (w/2 + padding.left) + "," + (h/2 + padding.top) + ")");

	        vis = container.append("g");
	        var pie = d3.layout.pie().sort(null).value(function(d){return 1;});
	        var arc = d3.svg.arc().outerRadius(r);
	        var arcs = vis.selectAll("g.slice")
	            .data(pie)
	            .enter()
	            .append("g")
	            .attr("class", "slice");
            
	        arcs.append("path")
	            .attr("fill", function(d, i){ return color(i); })
	            .attr("d", function (d) { return arc(d); });
        	// add the text
        	arcs.append("text").attr("transform", function(d){
                	d.innerRadius = 0;
                	d.outerRadius = r;
                	d.angle = (d.startAngle + d.endAngle)/2;
                	return "rotate(" + (d.angle * 180 / Math.PI - 90) + ")translate(" + (d.outerRadius -10) +")";
            		})
            		.attr("text-anchor", "end")
		            .text( function(d, i) {
		         		//return data.all_topics.label;
		         		return d.label;
		    });
        	container.on("click",spin);
        	var closed_flag =false;
        	svg.append("g").attr("transform", "translate(" + (w + padding.left + padding.right) + "," + ((h/2)+padding.top) + ")")
            .append("path")
            .attr("d", "M-" + (r*.15) + ",0L0," + (r*.05) + "L0,-" + (r*.05) + "Z")
            .style({"fill":"black"});

			container.append("circle")
	            .attr("cx", 0)
	            .attr("cy", 0)
	            .attr("r", 60)
	            .style({"fill":"white","cursor":"pointer"});
        	//spin text
        	container.append("text")
            .attr("x", 0)
            .attr("y", 15)
            .attr("text-anchor", "middle")
            .text("spin")
            .style({"font-weight":"bold", "font-size":"25px"});
        }

        
        
        
        function rotTween(to) {
          var i = d3.interpolate(oldrotation % 360, rotation);
          return function(t) {
            return "rotate(" + i(t) + ")";
          };
        }
        
        
        function getRandomNumbers(){
            var array = new Uint16Array(1000);
            var scale = d3.scale.linear().range([360, 1440]).domain([0, 100000]);
            if(window.hasOwnProperty("crypto") && typeof window.crypto.getRandomValues === "function"){
                window.crypto.getRandomValues(array);
                console.log("works");
            } 
            else {
                //no support for crypto, get crappy random numbers
                for(var i=0; i < 1000; i++){
                    array[i] = Math.floor(Math.random() * 100000) + 1;
                }
            }
            return array;
        }

        


		function playerBtnSet(){
			$('.vjs-big-play-button').each(function(i){
				var height = $(this).siblings('video').outerHeight();
				var width = $(this).siblings('video').outerWidth();
				var top = Math.round(height/2 - 30);
				var left = Math.round(width/2 - 30);

				$(this).css({
	    			'margin': '0',
	    			'top': ''+top+'px',
	    			'left': ''+left+'px',
				});
			});
		}

		

		// $('#saveanswer').hide();
  //       $('#op1').hide();
  //       $('#op2').hide();
  //       $('#op3').hide();
  //       $('#op4').hide();

  		function submit_assignment()
  		{
			var formData = new FormData();
			//console.log($('#assignment_file')[0]);
			var file=$('#assignment_file')[0].files[0];
			//console.log(files);
			formData.append('file', file);
			formData.append('user',"{{ user.id }}");
			var activity_id=$('#assignment_file').attr("data-attr");
  			formData.append("activity_id",activity_id);
			console.log(formData);
			$.ajax({
			     	url: '{% url "userlms:submit_assignment" %}',
			     	data: formData,
			     	contentType: false,
			     	processData: false,
			     	cache: false,
			     	type: 'POST',
			     	success: function(data) 
			     	{
			      		if(data.message=="Done"){
			      			alert("assignment submitted sucessfully");
			      		}
			      		else{
			      			alert(data.message);
			      		}
			      		if(data.activity){
							$('a[activity_id="'+data.activity+'"]').click();
			      		}
			      		if(data.percentage){
							$('.progress-bar').attr("aria-valuenow",data.percentage);
							$('.progress-bar').css("width",data.percentage);
			      		}
			     	}
			});
  		}

        $('.show_assignment_activity').click(function(){
			//if($('#assignment_activity_area').is(":hidden"))
			//{
				var ac_id =$(this).attr('data-attr');
				var url =$(this).attr('data-href');
				$('#assignment_file').attr('data-attr',ac_id);
				$('#activity_area').hide();
				$('#assignment_activity_area').hide();
				$('#spin_activity_area').hide();
				$("#course-start").hide();
				$('#drag_activity_area').hide();
				$('#quiz_activity_area').hide();

				// document.getElementById('assignment_activity_area').innerHTML="";
				function populatePre(url) {
					$('#assignment_activity_area').show();
					// document.getElementById('assignment_file_obj').setAttribute("data",window.location.host+url);
					// document.getElementById('assignment_file').setAttribute("src",window.location.host+url);
					document.getElementById('assignment_file_iframe').setAttribute("href", url);
					// document.getElementById('assignment_file_iframe').setAttribute("src","http://www.africau.edu/images/default/sample.pdf");
    				// var xhr = new XMLHttpRequest();
    				// xhr.onload = function () {
        // 				document.getElementById('assignment_content').textContent = this.responseText;
    				// };
    				// xhr.open('GET', url);
    				// xhr.send();
				}

				$.ajax({
					url:'{% url "userlms:get_activity" %}'+ac_id+"/",
					method:'post',
					success:function(data){
						populatePre(data);
					}
				});
			//}
			//dataStore('{% url "userlms:show_spin_activity" %}'+"/"+ac_id+"/");
		});

		$('.show_drag_activity').click(function(){
			var ac_id =$(this).attr('data-href');
			$('#activity_area').hide();
			$('#assignment_activity_area').hide();
			$('#drag_activity_area').show();
			$('#spin_activity_area').hide();
			$('#quiz_activity_area').hide();
			$('#course-start').hide();

			$.ajax({
				url:'{% url "customadmin:add_drag_element" %}'+ac_id+"/",
				type:'get',
				success:function(data){
					var activity_data = JSON.parse(data);
					console.log(activity_data);
					var act_d = activity_data.activity;
					act_d.settings = JSON.parse(act_d.settings_data);
					var x = {
						title : act_d.settings.title,
						width:act_d.settings.width,
						height:act_d.settings.height,
						background: {
							image:act_d.settings.background_image,
							src:act_d.settings.background_src,
							isColor:act_d.settings.background_isColor,
							color:act_d.settings.background_color,
						},
					};

					var elmt_d = activity_data.elements;
					var draggable = [];
					var droppable = [];
					for(var i in elmt_d ){
						let ed = elmt_d[i];
						ed.settings = JSON.parse(ed.settings_data);
						console.log("i", i);
						console.log(ed);
						if(ed.settings.type == "dropzone"){
							droppable.push({
							label:ed.settings.label,
							labelShow:(ed.settings.labelShow == "1") ? true : false,
							text:ed.settings.label,
							color:"#000000",
							elid:ed.id,
							backgroundOpacity: ed.settings.backgroundOpacity,
							//backgroundImage:ed.settings.background_image,
							backgroundColor:true,
							//backgroundSrc:ed.settings.src,
							correct:ed.settings.correctDroppables,
							border:true,
							borderColor:'#666',
							height:ed.settings.height +'px',
							width:ed.settings.width +'px',
							positionX: ed.settings.left,
							positionY:ed.settings.top,
						  });
						}else{
							if(ed.settings.type == "text"){
								draggable.push({
									type : "text",
									labelShow:(ed.settings.labelShow == "1") ? true : false,
									elid:ed.id,
									label:ed.settings.label,
									text:ed.settings.label,
									color:ed.settings.color,
									backgroundColor:ed.settings.backgroundColor,
									correct:ed.settings.canDroppables,
									height:ed.settings.height +'px',
									width:ed.settings.width +'px',
									positionX: ed.settings.left,
									positionY:ed.settings.top,
								});
							}else{
								draggable.push({
									type : "image",
									label:ed.settings.label,
									elid:ed.id,
									labelShow:(ed.settings.labelShow == "1") ? true : false,
									src:ed.settings.src,
									imageHoverText:ed.settings.imageHoverText,
									correct:ed.settings.canDroppables,
									height:ed.settings.height +'px',
									width:ed.settings.width +'px',
									positionX: ed.settings.left,
									positionY:ed.settings.top,
								});
							}
						}
					}
					var elements = {
						draggable : draggable,
						droppable : droppable
					};
					x.elements = elements;
					console.log("x" ,x);

					var activityPlayerConf = x;
				  	var html = '';
				  	var innerContent = '';

					if(activityPlayerConf != undefined)
					{
						document.querySelector('#activity_title').textContent = activityPlayerConf.title;
						var baseStyle = 'border:1px #000 solid; width:'+activityPlayerConf.width+'; height:'+activityPlayerConf.height+';';
						if(activityPlayerConf.background.image == true){
						  baseStyle += "background-image:url('"+activityPlayerConf.background.src+"'); background-size:contain; background-repeat:no-repeat; background-position:center;";
						}
						if(activityPlayerConf.background.isColor == true){
						  baseStyle += "background-color:"+activityPlayerConf.background.color+";";
						}
						html += '<div style="'+baseStyle+'" id="baseContainerElement">'+innerContent+'</div>';

						document.querySelector('#activityPlayer').innerHTML = html;
						var basePosition = $("#baseContainerElement").position();

						var elementsDraggable = activityPlayerConf.elements.draggable;
						var draggableHtml = '';
						for(var i in elementsDraggable){
						   draggableHtml += createDraggableElement(elementsDraggable[i], basePosition);
						}

						var elementsDroppable = activityPlayerConf.elements.droppable;
						var droppableHtml = '';
						for(var i in elementsDroppable){
						   droppableHtml += createDroppableElement(elementsDroppable[i], basePosition);
						}

						document.querySelector("#baseContainerElement").innerHTML = draggableHtml + droppableHtml;

						bindDraggable();
						bindDroppable();

					}
				}
			});



		});

		function quizStart(t){
			var cst = $(t).attr("cst");
			var url = "{{ EXTRA_URL }}"+$(t).attr("data-qrl");

			$.post(url,{start : "true"},function(data){
				console.log(data);
				show_Question(data);
			});
		
		}
		function quizInst(d){
			var data = d.questionpaper;
			var htm = '';
			if (data.quiz.is_expired){
          		htm = '<div class="alert alert-error">'+
              	'This Quiz has expired. You can no longer attempt this Quiz.'+
          		'</div>';
          	}

      		htm += '<p> Welcome <strong>{{user|title}}</strong>, to  quiz! </p>';
      		htm += data.quiz.instructions;
      		htm += '<div class="row">'+
        			'<div class="col-md-6">'+
          			'<center>';
            /*if (data.status != "moderator"){
              htm += '<a href="" class="btn btn-primary btn-lg" name="home">'+
                '<i class="fa fa-step-backward"></i> Go Back'+
              '</a>';
            }
            else{
              htm += '<a href="" class="btn btn-primary btn-lg" name="home">'+
                '<i class="fa fa-step-backward"></i> Go Back'+
              '</a>';
            }*/
          	htm += '</center>'+
				'</div>'+
				'<div class="col-md-6">';
			if (!data.quiz.is_expired){
				  htm += '<button class="btn btn-success btn-lg" cst="{{cst}}" data-qrl="'+ d.assessment_start_url +'" onclick="quizStart(this)">'+
					  'Start <i class="fa fa-play"></i>'+
					'</button>';
			 }
        	htm += '</div>'+
      			'</div>';

			return htm;

		}

		function show_quiz_complete_view(data){
			console.log(data);
			alert("Your Quiz is Completed");
			if(data.status == 1 && data.q_act == 1){

				var options = data.options;
				var q_type = 'Single Correct Answer';
				if(data.question.type == "mcc"){
					q_type = 'Multiple Correct Answer';
				}

				var pallete = '<div class="container-x" style="min-width:700px; margin:0 auto 0; text-align:center;">';

				var prev_id = 0;
				var next_id = 0;
				for (var q in data.paper.questions){
					if(data.question.id == data.paper.questions[q].id){
						pallete += '<button class="mx-1 btn btn-outline-success" onclick="loadQuizQuestId('+data.paper.questions[q].id+', '+data.questionpaper_id+', '+data.question.id+')">'+ (parseInt(q) + 1) +
						'</button>';
						if(q == 0){
							next_id = data.paper.questions[1].id;
						}else{
							prev_id = data.paper.questions[parseInt(q) - 1].id;
							if(q == (data.paper.questions.length - 1)){
								next_id = 0;
							}else{
								var count = (parseInt(q) + 1);
								next_id = data.paper.questions[count].id;
							}
						}
					}else{
						var count = (parseInt(q) + 1);
						pallete += '<button class="mx-1 btn btn-primary" onclick="loadQuizQuestId('+data.paper.questions[q].id+', '+data.questionpaper_id+', '+data.question.id+')">'+ count +
						'</button>';
					}
				}
				pallete += '</div>';
				var htm = pallete + '<div class="container-x my-1" style="min-width:700px; height:100%; margin:0 auto 0;">'+
					'<div class="question ml-sm-5 pl-sm-5 pt-2">'+
						'<div class="py-2 h5"><b>Q. '+data.question.question_name+'</b></div>'+
						'<div class="py-2 my-1" style="font-size:12px; border: 1px solid #fff;"><b>'+q_type+'</b></div>'+
						'<div class="ml-md-3 ml-sm-3 pl-md-5 pt-sm-0 pt-3 my-1" id="options">';

						if(data.question.type=="mcc"){
							if(options.option_a){
								htm += '<label class="options">'+options.option_a+' <input type="checkbox" name="quiz1" value="'+options.option_a+'"> <span class="checkmark"></span> </label>';
							}
							if(options.option_b){
								htm += '<label class="options">'+options.option_b+' <input type="checkbox" name="quiz1" value="'+options.option_b+'"> <span class="checkmark"></span> </label>';
							}
							if(options.option_c){
								htm += '<label class="options">'+options.option_c+' <input type="checkbox" name="quiz1" value='+options.option_c+'> <span class="checkmark"></span> </label>';
							}
							if(options.option_d){
								htm += '<label class="options">'+options.option_d+' <input type="checkbox" name="quiz1" value="'+options.option_d+'"> <span class="checkmark"></span> </label>';
							}
							if(options.option_e){
								htm += '<label class="options">'+options.option_e+' <input type="checkbox" name="quiz1" value="'+options.option_e+'"> <span class="checkmark"></span> </label>';
							}
						}else{
							if(options.option_a){
								htm += '<label class="options">'+options.option_a+' <input type="radio" name="quiz1" value="'+options.option_a+'"> <span class="checkmark"></span> </label>';
							}
							if(options.option_b){
								htm += '<label class="options">'+options.option_b+' <input type="radio" name="quiz1" value="'+options.option_b+'"> <span class="checkmark"></span> </label>';
							}
							if(options.option_c){
								htm += '<label class="options">'+options.option_c+' <input type="radio" name="quiz1" value="'+options.option_c+'"> <span class="checkmark"></span> </label>';
							}
							if(options.option_d){
								htm += '<label class="options">'+options.option_d+' <input type="radio" name="quiz1" value="'+options.option_d+'"> <span class="checkmark"></span> </label>';
							}
							if(options.option_e){
								htm += '<label class="options">'+options.option_e+' <input type="radio" name="quiz1" value="'+options.option_e+'"> <span class="checkmark"></span> </label>';
							}

						}

						htm += '</div>'+
					'</div>'+
					'<div class="d-flex align-items-center pt-3">';
					if(prev_id != 0){
						htm += '<div id="prev"> <button class="btn btn-primary-x" onclick="loadQuizQuestId('+prev_id+', '+data.questionpaper_id+', '+data.question.id+')">Previous</button> </div>';
					}
					if(next_id == 0){
						htm += '<div class="ml-auto mr-sm-5"> <button class="btn btn-success-x" onclick="loadQuizQuestId('+next_id+', '+data.questionpaper_id+', '+data.question.id+')">Submit</button> </div>';
					}else{
						htm += '<div class="ml-auto mr-sm-5"> <button class="btn btn-success-x" onclick="loadQuizQuestId('+next_id+', '+data.questionpaper_id+', '+data.question.id+')">Next</button> </div>';
					}
					htm += '</div>'+
				'</div>';


				$("#quiz-panel-body").hide();
				$("#quiz-play-body").css({
					"height": "100%",
				});
				$("#quiz-play-body").show();
				$("#quiz-play-body").html(htm);
			}else{
				alert(data.message);

				window.location.reload();
			}
		}
		function loadQuizQuestId(qid, qpid, current_qid){
			var attempt_counter = 1;

			var question_id = current_qid;
			var answer = '';
			var count = 0;
			$('input[name=quiz1]:checked').each(function(e){
				if(count == 0){
					answer = $(this).val();
					count++;
				}else{
					if(count == 1){
						var x = answer;
						answer = [];
						answer[0] = answer;
					}
					answer[count++] = $(this).val();
				}
			});
			var qd = {
				"question_id" : question_id,
				"answer" : answer,
			};
			$.ajax({
					url:"{{ EXTRA_URL }}/assesment/check_and_next_api/"+current_qid+"/"+attempt_counter+"/"+qpid+"/",
				type:'post',
				data:qd,
				success:function(data){
					console.log(data);
					if(qid == 0){
						$.ajax({
							url:"{{ EXTRA_URL }}/assesment/complete_api/"+attempt_counter+"/0/"+qpid+"/{{ object.id }}/",
							type:'post',
							data:{"data":0},
							success:function(data){
								console.log(data);
								show_quiz_complete_view(data);
							}
						});
					}else{
						show_Question(data);
					}
				}
			});

		}

	function showSkipDisabledMessage(){
   $("#quizMess").html('<div class="alert alert-danger" role="alert">Pallete navigation are blocked in this quiz. Please fill the answer and press next. </div>');
}
function show_Question(data){
   if(data.status == 1 && data.q_act == 1){
      var options = data.options;
      var q_type = 'Single Correct Answer';
      if(data.question.type == "mcc"){
         q_type = 'Multiple Correct Answer';
      }
      var pallete = '<div class="container-x" style="min-width:700px; margin:0 auto 0; text-align:center;">';
      var prev_id = 0;
      var next_id = 0;
      var question_order =  data.paper.questions_order.split(',')
      for (var qr in question_order){
         for (var q in data.paper.questions){
            if(question_order[qr] == data.paper.questions[q].id){
               if(data.question.id == data.paper.questions[q].id){
                  if(data.quiz.allow_skip){
                     pallete += '<button class="mx-1 btn btn-outline-success" onclick="loadQuizQuestId('+question_order[qr]+', '+data.questionpaper_id+', '+data.question.id+')">'+ (parseInt(qr) + 1) +
                     '</button>';
                  }else{
                     pallete += '<button class="mx-1 btn btn-outline-success" onclick="showSkipDisabledMessage()">'+ (parseInt(qr) + 1) +
                     '</button>';
                  }
                  if(qr == 0){
                     if(data.paper.questions.length > 1){
                        next_id = question_order[1];
                     }else{
                        next_id = 0;
                     }
                  }else{
                     prev_id = question_order[parseInt(qr) - 1];
                     if(qr == (question_order.length - 1)){
                        next_id = 0;
                     }else{
                        var count = (parseInt(qr) + 1);
                        next_id = question_order[count];
                     }
                  }
               }else{
                  var count = (parseInt(qr) + 1);
                  if(data.quiz.allow_skip){
                     pallete += '<button class="mx-1 btn btn-primary" onclick="loadQuizQuestId('+question_order[qr]+', '+data.questionpaper_id+', '+data.question.id+')">'+ count +
                     '</button>';
                  }else{
                     pallete += '<button class="mx-1 btn btn-primary" onclick="showSkipDisabledMessage()">'+ count +
                     '</button>';
                  }
               }
            }
         }
      }
      pallete += '<div id="quizMess" class="py-1"></div></div>';
      var htm = pallete + '<div class="container-x my-1" style="min-width:700px; height:100%; margin:0 auto 0;">'+
         '<div class="question ml-sm-5 pl-sm-5 pt-2">'+
            '<div class="py-2 h5"><b>Q. '+data.question.question_name+'</b></div>'+
            '<div class="py-2 my-1" style="font-size:12px; border: 1px solid #fff;"><b>'+q_type+'</b></div>'+
            '<div class="ml-md-3 ml-sm-3 pl-md-5 pt-sm-0 pt-3 my-1" id="options">';
            if(data.question.type=="mcc"){
               if(options.option_a){
                  htm += '<label class="options">'+options.option_a+' <input type="checkbox" name="quiz1" value="'+options.option_a+'"> <span class="checkmark"></span> </label>';
               }
               if(options.option_b){
                  htm += '<label class="options">'+options.option_b+' <input type="checkbox" name="quiz1" value="'+options.option_b+'"> <span class="checkmark"></span> </label>';
               }
               if(options.option_c){
                  htm += '<label class="options">'+options.option_c+' <input type="checkbox" name="quiz1" value='+options.option_c+'> <span class="checkmark"></span> </label>';
               }
               if(options.option_d){
                  htm += '<label class="options">'+options.option_d+' <input type="checkbox" name="quiz1" value="'+options.option_d+'"> <span class="checkmark"></span> </label>';
               }
               if(options.option_e){
                  htm += '<label class="options">'+options.option_e+' <input type="checkbox" name="quiz1" value="'+options.option_e+'"> <span class="checkmark"></span> </label>';
               }
            }else{
               if(options.option_a){
                  htm += '<label class="options">'+options.option_a+' <input type="radio" name="quiz1" value="'+options.option_a+'"> <span class="checkmark"></span> </label>';
               }
               if(options.option_b){
                  htm += '<label class="options">'+options.option_b+' <input type="radio" name="quiz1" value="'+options.option_b+'"> <span class="checkmark"></span> </label>';
               }
               if(options.option_c){
                  htm += '<label class="options">'+options.option_c+' <input type="radio" name="quiz1" value="'+options.option_c+'"> <span class="checkmark"></span> </label>';
               }
               if(options.option_d){
                  htm += '<label class="options">'+options.option_d+' <input type="radio" name="quiz1" value="'+options.option_d+'"> <span class="checkmark"></span> </label>';
               }
               if(options.option_e){
                  htm += '<label class="options">'+options.option_e+' <input type="radio" name="quiz1" value="'+options.option_e+'"> <span class="checkmark"></span> </label>';
               }
            }
            htm += '</div>'+
         '</div>'+
         '<div class="d-flex align-items-center pt-3">';
         if(prev_id != 0){
            htm += '<div id="prev"> <button class="btn btn-primary-x" onclick="loadQuizQuestId('+prev_id+', '+data.questionpaper_id+', '+data.question.id+')">Previous</button> </div>';
         }
         if(next_id == 0){
            htm += '<div class="ml-auto mr-sm-5"> <button class="btn btn-success-x" onclick="loadQuizQuestId('+next_id+', '+data.questionpaper_id+', '+data.question.id+')">Submit</button> </div>';
         }else{
            htm += '<div class="ml-auto mr-sm-5"> <button class="btn btn-success-x" onclick="loadQuizQuestId('+next_id+', '+data.questionpaper_id+', '+data.question.id+')">Next</button> </div>';
         }
         htm += '</div>'+
      '</div>';

      $("#quiz-panel-body").hide();
      $("#quiz-play-body").css({
         "height": "100%",
      });
      $("#quiz-play-body").show();
      $("#quiz-play-body").html(htm);
   }else{
       alert(data.message);
       $('a[activity_id="'+data.activity+'"]').click();
      //window.location.reload();
   }
}
		// function show_Question(data){
		// 	if(data.status == 1 && data.q_act == 1){

		// 		var options = data.options;
		// 		var q_type = 'Single Correct Answer';
		// 		if(data.question.type == "mcc"){
		// 			q_type = 'Multiple Correct Answer';
		// 		}

		// 		var pallete = '<div class="container-x" style="min-width:700px; margin:0 auto 0; text-align:center;">';

		// 		var prev_id = 0;
		// 		var next_id = 0;
		// 		for (var q in data.paper.questions){
		// 			if(data.question.id == data.paper.questions[q].id){
		// 				pallete += '<button class="mx-1 btn btn-outline-success" onclick="loadQuizQuestId('+data.paper.questions[q].id+', '+data.questionpaper_id+', '+data.question.id+')">'+ (parseInt(q) + 1) +
		// 				'</button>';
		// 				if(q == 0){
		// 					next_id = data.paper.questions[1].id;
		// 				}else{
		// 					prev_id = data.paper.questions[parseInt(q) - 1].id;
		// 					if(q == (data.paper.questions.length - 1)){
		// 						next_id = 0;
		// 					}else{
		// 						var count = (parseInt(q) + 1);
		// 						next_id = data.paper.questions[count].id;
		// 					}
		// 				}
		// 			}else{
		// 				var count = (parseInt(q) + 1);
		// 				pallete += '<button class="mx-1 btn btn-primary" onclick="loadQuizQuestId('+data.paper.questions[q].id+', '+data.questionpaper_id+', '+data.question.id+')">'+ count +
		// 				'</button>';
		// 			}
		// 		}
		// 		pallete += '</div>';
		// 		var htm = pallete + '<div class="container-x my-1" style="min-width:700px; height:100%; margin:0 auto 0;">'+
		// 			'<div class="question ml-sm-5 pl-sm-5 pt-2">'+
		// 				'<div class="py-2 h5"><b>Q. '+data.question.question_name+'</b></div>'+
		// 				'<div class="py-2 my-1" style="font-size:12px; border: 1px solid #fff;"><b>'+q_type+'</b></div>'+
		// 				'<div class="ml-md-3 ml-sm-3 pl-md-5 pt-sm-0 pt-3 my-1" id="options">';

		// 				if(data.question.type=="mcc"){
		// 					if(options.option_a){
		// 						htm += '<label class="options">'+options.option_a+' <input type="checkbox" name="quiz1" value="'+options.option_a+'"> <span class="checkmark"></span> </label>';
		// 					}
		// 					if(options.option_b){
		// 						htm += '<label class="options">'+options.option_b+' <input type="checkbox" name="quiz1" value="'+options.option_b+'"> <span class="checkmark"></span> </label>';
		// 					}
		// 					if(options.option_c){
		// 						htm += '<label class="options">'+options.option_c+' <input type="checkbox" name="quiz1" value='+options.option_c+'> <span class="checkmark"></span> </label>';
		// 					}
		// 					if(options.option_d){
		// 						htm += '<label class="options">'+options.option_d+' <input type="checkbox" name="quiz1" value="'+options.option_d+'"> <span class="checkmark"></span> </label>';
		// 					}
		// 					if(options.option_e){
		// 						htm += '<label class="options">'+options.option_e+' <input type="checkbox" name="quiz1" value="'+options.option_e+'"> <span class="checkmark"></span> </label>';
		// 					}
		// 				}else{
		// 					if(options.option_a){
		// 						htm += '<label class="options">'+options.option_a+' <input type="radio" name="quiz1" value="'+options.option_a+'"> <span class="checkmark"></span> </label>';
		// 					}
		// 					if(options.option_b){
		// 						htm += '<label class="options">'+options.option_b+' <input type="radio" name="quiz1" value="'+options.option_b+'"> <span class="checkmark"></span> </label>';
		// 					}
		// 					if(options.option_c){
		// 						htm += '<label class="options">'+options.option_c+' <input type="radio" name="quiz1" value="'+options.option_c+'"> <span class="checkmark"></span> </label>';
		// 					}
		// 					if(options.option_d){
		// 						htm += '<label class="options">'+options.option_d+' <input type="radio" name="quiz1" value="'+options.option_d+'"> <span class="checkmark"></span> </label>';
		// 					}
		// 					if(options.option_e){
		// 						htm += '<label class="options">'+options.option_e+' <input type="radio" name="quiz1" value="'+options.option_e+'"> <span class="checkmark"></span> </label>';
		// 					}

		// 				}

		// 				htm += '</div>'+
		// 			'</div>'+
		// 			'<div class="d-flex align-items-center pt-3">';
		// 			if(prev_id != 0){
		// 				htm += '<div id="prev"> <button class="btn btn-primary-x" onclick="loadQuizQuestId('+prev_id+', '+data.questionpaper_id+', '+data.question.id+')">Previous</button> </div>';
		// 			}
		// 			if(next_id == 0){
		// 				htm += '<div class="ml-auto mr-sm-5"> <button class="btn btn-success-x" onclick="loadQuizQuestId('+next_id+', '+data.questionpaper_id+', '+data.question.id+')">Submit</button> </div>';
		// 			}else{
		// 				htm += '<div class="ml-auto mr-sm-5"> <button class="btn btn-success-x" onclick="loadQuizQuestId('+next_id+', '+data.questionpaper_id+', '+data.question.id+')">Next</button> </div>';
		// 			}
		// 			htm += '</div>'+
		// 		'</div>';


		// 		$("#quiz-panel-body").hide();
		// 		$("#quiz-play-body").css({
		// 			"height": "100%",
		// 		});
		// 		$("#quiz-play-body").show();
		// 		$("#quiz-play-body").html(htm);
		// 	}else{
		// 		alert(data.message);
		// 		window.location.reload();
		// 	}
		// }
		function exitHandler(){
			$("#activity_box_area").removeClass('full-screen-div');
				$("#activity_screen_resize").html('<span class="fa fa-expand"></span>');
				$("#activity_screen_resize").siblings('div').css({
					'width': '100%',
					'height':'500px'
				});
				$(this).attr('data-fullscreen', "False");
		}
		/*
		document.addEventListener('fullscreenchange', exitHandler, false);
		 document.addEventListener('mozfullscreenchange', exitHandler, false);
		 document.addEventListener('MSFullscreenChange', exitHandler, false);
		 document.addEventListener('webkitfullscreenchange', exitHandler, false);
		 */


		function getTimeRemaining(endtime){
		  var t = Date.parse(endtime) - Date.parse(new Date());
		  var seconds = Math.floor( (t/1000) % 60 );
		  var minutes = Math.floor( (t/1000/60) % 60 );
		  var hours = Math.floor( (t/(1000*60*60)) % 24 );
		  var days = Math.floor( t/(1000*60*60*24) );
		  return {
		    'total': t,
		    'days': days,
		    'hours': hours,
		    'minutes': minutes,
		    'seconds': seconds
		  };
		}

		function updateTime()
		{
		  
			var timeInSeconds = time_left;
			var currentTime = Date.parse(new Date());
			var deadline = new Date(currentTime + timeInSeconds*1000);

			function updateClock(){
			    var t = getTimeRemaining(deadline);
			    var hh = ('0' + t.hours).slice(-2);
			    var mm = ('0' + t.minutes).slice(-2);
			    var ss = ('0' + t.seconds).slice(-2);

			    if(t.total<0 && is_exercise=="False"){
			      document.forms["code"].submit();
			      clearInterval(timeinterval);
			      return null;
			    }
			    if(t.total<=0 && is_exercise=="True"){
			      clearInterval(timeinterval);
			    }
			    if (t.total<=300000 && t.total > 0){
			        clock.innerHTML = "<blink><center><span style='color:red'><strong>" + hh + ":" + mm + ":" + ss + "</strong></center></span></blink>";
			    }
			    if (t.total>=300000) {
			        clock.innerHTML = "<center><strong>" + hh + ":" + mm + ":" + ss + "</strong></center>";
			    }
			}
			updateClock();
			var timeinterval = setInterval(updateClock,1000);

		}

		function validate(){
		    uploaded_file = document.getElementById("assignment").value;
		    if(uploaded_file == ""){
		        $("#upload_alert").modal("show");
		        return false;
		    }
		    return true;
		}

		function call_skip(url)
		{
		    form = document.forms["code"]
		    form.action = url
		    form.submit();
		}

		$('.show_quiz_activity').click(function(){
			var assess_url ='{{ EXTRA_URL}}'+$(this).attr('data-href');
			//$("#activity_screen_resize").trigger('click');

			$.ajax({
				url:assess_url,
				type:'get',
				success:function(data){
					console.log(data);
					$('#activity_area').hide();
					$('#assignment_activity_area').hide();
					$('#drag_activity_area').hide();
					$('#spin_activity_area').hide();
					$("#course-start").hide();
					$('#quiz_activity_area').show();

					var instHtml = quizInst(data);
					$("#quiz-panel-body").html(instHtml);
				}
			});



		});

		$('.show_spin_activity').click(function(){
			//if($('#spin_activity_area').is(":hidden"))
			//{
				var ac_id =$(this).attr('data-attr');
				var url =$(this).attr('data-href');
				$('#activity_area').hide();
				$('#assignment_activity_area').hide();
				$('#drag_activity_area').hide();
				$('#quiz_activity_area').hide();
				$('#spin_activity_area').hide();
				$("#course-start").hide();
				spinactivity_id = ac_id;
				document.getElementById('spin_activity_area').innerHTML="";
				spin_data = null;
				document.getElementById('spin_activity_area').innerHTML='<div class="col-md-6"><div id="chart"></div></div><div class="col-md-6" style="display:none" id="spin_questions"><div id="question" style="margin-top:50px;"><h3 id="questionheader" style="font-size:17px;"data-qid=""></h3><div class="options" style="padding:10px;"><p style="list-style: none"><input type="radio" name="op" data-aid="" id="op1"><label id="label_op1" for="op1"></label> <br/><input type="radio" name="op"  data-aid="" id="op2"><label id="label_op2" for="op2"></label><br/><input type="radio" name="op"  data-aid="" id="op3"><label id="label_op3" for="op3"></label><br/><input type="radio" name="op" data-aid="" id="op4"><label id="label_op4" for="op4"></label><br/></p><button class="btn btn-success" id="saveanswer" data-sid="" value="saveanswer" onclick="saveanswer()">Save Answer</button></div></div></div>';

				$.ajax({
						url:"{% url 'userlms:show_spin_activity' %}/"+ac_id+"/",
						type:'post',
						success:function(data){
						var dd=JSON.parse(data)
						spin_data=dd.alltopics
						// top=spin_data.found_topic
						// console.log("TTTTTTTTTTTTTTTTTTTT");
						// console.log(top);
						// console.log(spin_data);
						create_spin(dd.alltopics);
						$('#spin_activity_area').show();
						//$('#spin_activity_area').html(data);
						//var data=[];
	       				set_spin_question(dd.alltopics)
						}
				});
			//}
			//dataStore('{% url "userlms:show_spin_activity" %}'+"/"+ac_id+"/");
		});

		function saveanswer()
		{
        	//alert();
      // get selected radio button id or value
		  var radioValue = $("input[name='op']:checked").val();
          var attrid = $("input[name='op']:checked").attr('id')

          if(attrid=='op1'){
            var opt='a';
          }
          else if(attrid=='op2'){
            var opt='b';
          }
          else if(attrid=='op3'){
            var opt='c';
          }
          else{
            var opt='d';
          }

          console.log(opt);
          //console.log(spinactivity_id);
          //console.log($('#questionheader').attr('data-qid'));
      	   //var spinactivity_id=null;
           $.post("{{ EXTRA_URL }}/admin/store_ans_spin/",
           {
             'questionid':$('#questionheader').attr('data-qid'),
             'answerid':opt,
             'spinactivityid':spinactivity_id,
            },
            function(data, status){
              alert("answer saved successfully");

            });
            //alert(data.length);
            //alert(oldpick.length);
            if(data.length==oldpick.length)
            {     //alert("slice length");
                   $.post("{% url 'userlms:activity_completed' %}",
                    {
                         'activityid':spinactivity_id,
                         'userid':"{{user.id}}",
                         'type':"spin_activity"
                        },
                        function(data, status){
                          //alert(data);
                          alert(data.message);
                          $('a[activity_id="'+data.activity+'"]').click();
						  $('a[activity_id="'+data.activity+'"]').css('color','green');
                          //window.location.href=window.location.href;
                    });
            }

		}

		function set_spin_question(all_topics)
		{
			for (var i=0;i<all_topics.length;i++)
        	{
		          topic=all_topics[i]
		          var temp={}
		          temp.label=topic.topic_name;
		          qlength=topic.questions.length;
		          questions=topic.questions
		          temp.value=qlength;
		          qarray=[];
		          for (var j=0;j<qlength;j++)
		          {
		            
		            qarray.push({'qid':questions[j].qid,'q':questions[j].q,'op1':questions[j].op1,'op2':questions[j].op2,'op3':questions[j].op3,'op4':questions[j].op4});
		          }
		          temp.question=qarray
		          //data.push(temp)
        	}
		}

		function videoPlayerCondition(d){

			var video = document.getElementById('my-player_html5_api');
			var supposedCurrentTime = 0;
			video.addEventListener('timeupdate', function() {
			  if (!video.seeking) {
			        supposedCurrentTime = video.currentTime;
			  }
			});
			// prevent user from seeking
			video.addEventListener('seeking', function() {
			  // guard agains infinite recursion:
			  // user seeks, seeking is fired, currentTime is modified, seeking is fired, current time is modified, ....
			  var delta = video.currentTime - supposedCurrentTime;
			  if (Math.abs(delta) > 0.01) {
			    //console.log("Seeking is disabled");
			    video.currentTime = supposedCurrentTime;
			  }
			});
			// delete the following event handler if rewind is not required
			video.addEventListener('ended', function() {
			  // reset state in order to allow for rewind
			    supposedCurrentTime = 0;
			});
		}

		$(document).ready(function(e){
			var course_details = JSON.parse(document.getElementById('course_about').textContent);

			//var course_highlights = JSON.parse(document.getElementById('course_highlights').textContent);
			var course_overview = JSON.parse(document.getElementById('course_overview').textContent);
			$('#course-abouts').html(course_details);
			$('#contentForAbout').html(course_details);
			//$('#contentForWatchingLive').html(course_overview);
			$("ul").css('list-style-type', "none");

			$('.vjs-big-play-button').addClass('player-ply-btn');
			var video = document.getElementById('my-player_html5_api');

			video.addEventListener("ended", function(){
				//alert("video ended");
				//get next_module and open it
				var topicid=$(this).attr("topicid");
				var videoid=$(this).attr("videoid");
				$.ajax({
					url:'{% url "userlms:open_next_topic" %}',
					type:'post',
					data:{'topic':topicid,'activity':videoid},
					success:function(data){
						//alert(data);
						//var res=JSON.parse(data);
						//alert(res.message);
						if(data.message=="Done"){
							// $('a["activity_id"='+res.activity+']').click();
							$('a[activity_id="'+data.activity+'"]').click();
							$('a[activity_id="'+data.activity+'"]').css('color','green');
						}
						
						//window.location.href = window.location.href;
					}
				});


			});


			$("#activity_screen_resize").click(function(e)
			{
				var scr_attr = $(this).attr('data-fullscreen');
				if(scr_attr == "False"){
					document.documentElement.requestFullscreen();
					$("#activity_box_area").addClass('full-screen-div');
					$("#activity_box_area").children('div').css({
						'width': '100%',
						'height':'100%',
						'max-height':'100%'
					});
					$("#activity_screen_resize").html('<span class="fa fa-compress"></span>');
					$("#activity_screen_resize").siblings('div').css({
						'width': '100%',
						'height':'100%'
					});
					$(this).attr('data-fullscreen', "True");
				}
				else
				{
					$("#activity_box_area").removeClass('full-screen-div');
					$("#activity_box_area").children('div').css({
						'width': '100%',
						'height':'500px',
						'max-height':'500px'
					});
					$("#activity_screen_resize").html('<span class="fa fa-expand"></span>');
					$("#activity_screen_resize").siblings('div').css({
						'width': '100%',
						'height':'500px'
					});
					$(this).attr('data-fullscreen', "False");
					document.exitFullscreen();
				}
				playerBtnSet();
			});

			$("ul").css('list-style-type', "none");

			$('.carousel-item').each(function(e){
				$(this).children('.pop-card').each(function(i){
					if(i >= 2){
						$(this).children('.pop-card-hover').css('left', '-305px');
					}
				});
			});
			
		});

		$('.open_popup').click(function(){
			var url =$(this).attr('data-href');
			window.open(url,"activity",'toolbar=no,fullscreen=yes,titlebar=no,menubar=no');
		});



		

		// var course_id = JSON.parse(document.getElementById('course_id').textContent);
  		$('#qa-submit').click(function(){
  			var discuss=$('#qa-discuss').val();
  			var courseid="{{ object.id }}";
  			var userid="{{ user.id }}";
  			$.ajax({
  				url:'{% url "userlms:add_discussion" %}',
  				type:'post',
  				data:{'discuss':discuss,'author':userid,'course':courseid },
  				success:function(data){
  					//alert(data);
  					window.location.href = window.location.href;
  				}
  			});
  		});

        //var x=document.getElementById('person_list');
        // const roomName = JSON.parse(document.getElementById('room-name').textContent);
      
        // var l_rcp=document.getElementById("recp_list");


        
                    

  				
	</script>
	<!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script> -->
	<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
    
	<script>



	$(document).ready(function()
	{
		var roomName="{{ room.room_id }}";
		var user ="{{ user.id }}";
		var course ="{{ object.id }}";
		
		chatSocket = new WebSocket(
            'wss://'
            + window.location.host
            + '/ws/chat/'
            + roomName
            + '/'+user+'/'
        );
        //console.log(chatSocket);

        chatSocket.onopen = function open() {
    		let now = new Date();
    		console.log("connected socket")
    		console.info(now.toLocaleString() + ':' + now.getMilliseconds() + ' – WebSocket connection created.');
		};

        chatSocket.onmessage = function(e) {
            const data = JSON.parse(e.data);
            console.log(data);
            if(typeof(data.userlist)!='undefined')
            { 

               var watchinglive = $('#contentForWatchingLive');
				watchinglive.html('');
               for(var i=0;i< data.userlist.length;i++)
               {
               		//console.log(data.userlist[i]);
               		if(data.userlist[i].user_id!=user)
               		{
               			watchinglive.append('<p>'+	
									'<div class="row">'+
			                            	'<div class="col-md-2">'+
			                                	'<img src="{% static 'user_lms/img/user.png' %}" class="img-circle img-responsive" style="border-radius: 50%;" height="50" width="50"  alt="" />'+
			                            	'</div><div class="col-md-10"><div class="mic-info"><a href="#">'+data.userlist[i].username+'</a> </div> <div class="comment-text" style="float: right;margin-right:70px;"><button type="button" class="btn btn-primary chatmodalopen" data-href="'+data.userlist[i].username+'" onclick="openchatmodal(this)">Chat</button></div></div></div></p>');
               	 	}
               }

               
               //var options = document.querySelectorAll('#person_list option');
               // options.forEach(o => o.remove());

               //  for(var i=0;i< data.userlist.length;i++)
               //  {
               //      var option = document.createElement("option");
               //      option.text = data.userlist[i];
               //      option.value=data.userlist[i];
               //      x.add(option, x[i]);
               //  } 
                
            }
            // else if(data.file){
            //     var aTag = document.createElement('a');
            //     aTag.setAttribute('href',"/chat/get_file/"+data.message);
            //     aTag.innerText = data.message;
            //     // html_response='<a href="/chat/get_file/">'+data.message+'</a>';
            //    //document.querySelector('#chat-log').value += (aTag + '\n'); 
            //    document.querySelector('#chat-log').appendChild(aTag);
            //    document.querySelector('#chat-log').value += '\n';
            // }
            else
            {
               document.querySelector('.chatpmessage').innerText += (data.message + '\n');
            }
            
        };

        chatSocket.onclose = function(e) {
            console.error('Chat socket closed unexpectedly');
         //    chatSocket = new WebSocket(
         //    'ws://'
         //    + window.location.host
         //    + '/ws/chat/'
         //    + roomName
         //    + '/'+user+'/'
        	// );
        };

        chatSocket.onerror = function(error) {
    		let now = new Date();
    		let msg = now.toLocaleString() + ':' + now.getMilliseconds() + ' – WebSocket error: ' + error;
    		console.error(msg);
		}

		window.addEventListener("unload", function () {
    		if(chatSocket.readyState == WebSocket.OPEN)
        		chatSocket.close();
		});

		// setInterval(function(){ 
		// 	var courseid="{{ object.id }}"
		// 	$.ajax({
		// 		url:'{% url "userlms:get_online_user" %}',
		// 		data:{'course':courseid},
		// 		type:'post',
		// 		success:function(data){
		// 			//console.log(data);
		// 			var all_user=JSON.parse(data);
					
		// 			var watchinglive = $('#contentForWatchingLive');
		// 			watchinglive.html('');
		// 			//console.log(all_user);
		// 			//console.log(all_user.length);
		// 			var i=0;
		// 			for(i=0;i< all_user.users.length;i++)
  //  					{
  //  						//console.log(all_user);
  //    //           		//data.userlist[i]
  //    //           		console.log(all_user[i]);
  //    				var o_user=all_user.users[i];

  //              		watchinglive.append('<p><div class="row"><div class="col-md-2"><img src="{% static 'user_lms/img/user.png' %}" class="img-circle img-responsive" style="border-radius: 50%;" height="50" width="50"  alt="" /></div><div class="col-md-10"><div class="mic-info"><a href="#">'+
		// 	                            	o_user+'</a> </div> <div class="comment-text" style="float: right;margin-right:70px;"><button type="button" class="btn btn-primary chatmodalopen" data-href="'+o_user+'" onclick="openchatmodal(this)">Chat</button></div></div></div></p>');
  //              			//$('.chatModal').attr("data-href","");
  //             			//$('.chatModal').attr("data-href",o_user);
  //             		}
		// 		}
		// 	});
		// }, 3000);

        // document.querySelector('#chat-message-input').focus();
        // document.querySelector('#chat-message-input').onkeyup = function(e) {
        //     if (e.keyCode === 13) {  // enter, return
        //         document.querySelector('#chat-message-submit').click();
        //     }
        // };

        // $('#chatmodalopen').click(function(){
        // 	alert();
        // });
        document.querySelector('#chattextsubmit').onclick = function(e) 
        {
        	//alert('f');
            const messageInputDom = document.querySelector('#chattext');
            const message = messageInputDom.value;
            //var to_send=document.getElementById("person_list").value;
            var to_send = $('#chatModal').attr("data-href");
            //alert("sending to "+to_send);

            chatSocket.send(JSON.stringify({
                'message': message,
                'to_send':to_send,
                'from':"{{ user.id }}",
                'course':"{{ object.id }}",
                'type':'text',
                
            }));
            messageInputDom.value = '';
            document.querySelector('.chatpmessage').innerText += ('you: '+message + '\n');

        };
        
	});

	function openchatmodal(param)
	{
		var username=param.getAttribute("data-href");
		//alert(username);
		$('#chatModal').attr("data-href",username);

		$('#chatModal').modal('show');
	}


	</script>


	
	<script>

    function createDraggableElement(elementConf, basePosition){
      let item = '';
      var hw = 'width:'+elementConf.width+';height:'+elementConf.height+';';
          var draggableStyle = 'position:absolute; top:'+(basePosition.top+parseInt(elementConf.positionY))+'px; left:'+(basePosition.top+parseInt(elementConf.positionX))+'px; color:'+elementConf.color+';'+hw;
          if(elementConf.border != undefined && elementConf.border == true){
            draggableStyle += 'border:1px '+elementConf.borderColor+' solid;';
          }

          item += '<div style="'+draggableStyle+'" class="makeDraggable" data-draggable="'+elementConf.elid+'">';

          if(elementConf.labelShow == true){
            item += '<label>'+elementConf.label+'</label>';
          }

          if(elementConf.type == "text"){
            item += '<div stye="'+hw+'">'+elementConf.text+'</div>';
          }

          if(elementConf.type == "image"){
            item += '<img stye="'+hw+'" src="'+elementConf.src+'"/>';
          }

          if(elementConf.type == "rect"){
            item += '<div style="background-color:'+elementConf.background+'; color:'+elementConf.color+'; '+hw+'" ><p>'+elementConf.text+'</p></div>';
          }

          item += '</div>';

          return item;
    }


    function createDroppableElement(elementConf, basePosition){
      let item = '';
      var hw = 'width:'+elementConf.width+';height:'+elementConf.height+';';
          var draggableStyle = 'position:absolute; top:'+(basePosition.top+parseInt(elementConf.positionY))+'px; left:'+(basePosition.top+parseInt(elementConf.positionX))+'px; color:'+elementConf.color+';'+hw;
          if(elementConf.border != undefined && elementConf.border == true){
            draggableStyle += 'border:1px '+elementConf.borderColor+' solid;';
          }

          if(elementConf.backgroundImage == true){
            draggableStyle += "background-image:url('"+elementConf.backgroundSrc+"'); background-size:contain; background-position:center; background-repeat:no-repeat;";
          }

          item += '<div style="'+draggableStyle+'" class="makeDroppable" data-droppable="'+elementConf.elid+'">';

          if(elementConf.labelShow == true){
            item += '<label>'+elementConf.label+'</label>';
          }

          if(elementConf.text == true){
            item += '<p>'+elementConf.text+'</p>';
          }

          item += '</div>';

          return item;
    }


    function bindDraggable(){
      $(".makeDraggable").draggable({ revert: 'invalid' });
    }

    function bindDroppable(){
      var dropablesData = [];
      $(".makeDroppable").droppable({
        drop: function(event, ui) {
          var opid = $(ui.draggable).attr('data-draggable');
          var dropid = $(this).attr('data-droppable');
          if(dropablesData[dropid] != undefined){
            if(Array.isArray(dropablesData[dropid])){
              dropablesData[dropid].push(opid);
            }else{
              dropablesData[dropid] = new Array();
              dropablesData[dropid].push(opid);
            }
          }else{
            dropablesData[dropid] = new Array();
            dropablesData[dropid].push(opid);
          }
          console.log(dropablesData);
          //return $(ui.draggable).addClass('drag-revert');
          
          alert('You just droped an element inside this droppable zone');
        }
      });
    }

	</script>
	
{% endblock %}
